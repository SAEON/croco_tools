<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2002-2-1 (1.70) JA patch-2.0
patched version by:  Kenshi Muto, Debian Project.
* modified by:  Shige TAKENO
LaTeX2HTML 2002-2-1 (1.70),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>doc</TITLE>
<META NAME="description" CONTENT="doc">
<META NAME="keywords" CONTENT="doc">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="jLaTeX2HTML v2002-2-1 JA patch-2.0">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="doc.css">

</HEAD>

<BODY >

<DIV ALIGN="CENTER">
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<FONT SIZE="+3"><B>ROMSTOOLS User's Guide </B></FONT>
<BR><BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<FONT SIZE="+2">Pierrick Penven and Thi-Anh Tan</FONT>
<BR><BR>
<BR>
<BR>
<FONT SIZE="+1">Institut de Recherche pour le D&#233;veloppement (IRD),
213 rue Lafayette, Paris,
France</FONT> 
<BR><BR>
<BR>
<BR>
<BR>
<BR>
<BR>
</DIV><DIV ALIGN="CENTER"><DIV ALIGN="CENTER">
figure=roms_gui.eps,width=11cm</DIV></DIV>
<DIV ALIGN="CENTER"><BR>
<BR>
<BR>
</DIV>
<P>
<DIV ALIGN="CENTER">July, 2007
</DIV>
<P>
<DIV ALIGN="CENTER">
</DIV>

<P>

<BR>

<H2><A NAME="SECTION00010000000000000000">
Contents</A>
</H2>
<!--Table of Contents-->

<UL>
<LI><A NAME="tex2html44"
  HREF="doc.html#SECTION00020000000000000000">1 Introduction</A>
<UL>
<LI><A NAME="tex2html45"
  HREF="doc.html#SECTION00021000000000000000">1.1 Installation</A>
<LI><A NAME="tex2html46"
  HREF="doc.html#SECTION00022000000000000000">1.2 Future plans</A>
<LI><A NAME="tex2html47"
  HREF="doc.html#SECTION00023000000000000000">1.3 Warning and bugs</A>
</UL><BR>
<LI><A NAME="tex2html48"
  HREF="doc.html#SECTION00030000000000000000">2 The ROMS model</A>
<LI><A NAME="tex2html49"
  HREF="doc.html#SECTION00040000000000000000">3 Tutorial : the Southern Benguela example</A>
<UL>
<LI><A NAME="tex2html50"
  HREF="doc.html#SECTION00041000000000000000">3.1 Getting started</A>
<LI><A NAME="tex2html51"
  HREF="doc.html#SECTION00042000000000000000">3.2 Building the grid</A>
<LI><A NAME="tex2html52"
  HREF="doc.html#SECTION00043000000000000000">3.3 Getting the wind and other surface fluxes</A>
<LI><A NAME="tex2html53"
  HREF="doc.html#SECTION00044000000000000000">3.4 Getting the initial and the lateral boundary conditions</A>
<LI><A NAME="tex2html54"
  HREF="doc.html#SECTION00045000000000000000">3.5 Compiling the model</A>
<LI><A NAME="tex2html55"
  HREF="doc.html#SECTION00046000000000000000">3.6 Running the model</A>
<LI><A NAME="tex2html56"
  HREF="doc.html#SECTION00047000000000000000">3.7 Long simulations</A>
<LI><A NAME="tex2html57"
  HREF="doc.html#SECTION00048000000000000000">3.8 Getting the results</A>
</UL><BR>
<LI><A NAME="tex2html58"
  HREF="doc.html#SECTION00050000000000000000">4 Tides</A>
<LI><A NAME="tex2html59"
  HREF="doc.html#SECTION00060000000000000000">5 Inter-Annual simulations</A>
<UL>
<LI><A NAME="tex2html60"
  HREF="doc.html#SECTION00061000000000000000">5.1 Getting the surface forcing data from NCEP</A>
<LI><A NAME="tex2html61"
  HREF="doc.html#SECTION00062000000000000000">5.2 Getting the lateral boundary conditions</A>
<LI><A NAME="tex2html62"
  HREF="doc.html#SECTION00063000000000000000">5.3 Running the model</A>
</UL><BR>
<LI><A NAME="tex2html63"
  HREF="doc.html#SECTION00070000000000000000">6 Embedding</A>
<UL>
<LI><A NAME="tex2html64"
  HREF="doc.html#SECTION00071000000000000000">6.1 Introduction</A>
<LI><A NAME="tex2html65"
  HREF="doc.html#SECTION00072000000000000000">6.2 Embedded (child) model preparation</A>
<LI><A NAME="tex2html66"
  HREF="doc.html#SECTION00073000000000000000">6.3 Compiling and running the model</A>
</UL><BR>
<LI><A NAME="tex2html67"
  HREF="doc.html#SECTION00080000000000000000">7 Biology</A>
<LI><A NAME="tex2html68"
  HREF="doc.html#SECTION00090000000000000000">8 Operational coastal modeling system</A>
<LI><A NAME="tex2html69"
  HREF="doc.html#SECTION000100000000000000000">Bibliography</A>
</UL>
<!--End of Table of Contents-->

<P>

<H1><A NAME="SECTION00020000000000000000">
1 Introduction</A>
</H1>
This guide presents a series of Matlab routines which
could be useful for the pre- and post-processing of oceanic
regional ROMS simulations. This guide is just a basic 
users guide, details of the methods and datasets are
described in <A
 HREF="doc.html#Pen07">Penven et al.  (2007)</A>.

<P>
The Regional Ocean Modeling System (ROMS) is a new
generation ocean circulation model (<A
 HREF="doc.html#Shc03b">Shchepetkin and McWilliams, 2005</A>)
that has been specially designed for accurate simulations
of regional oceanic systems.
The reader is referred to <A
 HREF="doc.html#Shc03a">Shchepetkin and McWilliams (2003)</A> and to 
<A
 HREF="doc.html#Shc03b">Shchepetkin and McWilliams (2005)</A> for a complete description of the model.
ROMS has been applied for the regional simulation of a 
variety of different regions of the world oceans 
(e.g. <A NAME="tex2html70"
  HREF="doc.html#Mar03">Marchesiello et al., 2003</A>; <A NAME="tex2html71"
  HREF="doc.html#Pen01">Penven et al., 2001</A>; <A NAME="tex2html72"
  HREF="doc.html#Mac02">MacCready et al., 2002</A>; <A NAME="tex2html73"
  HREF="doc.html#Hai00">Haidvogel et al., 2000</A>; <A NAME="tex2html74"
  HREF="doc.html#Dil03">Di Lorenzo et al., 2003</A>; <A NAME="tex2html75"
  HREF="doc.html#Bla02">Blanke et al., 2002</A>).

<P>
To perform a regional simulation using ROMS, the modeler 
needs to provide several data files in a specific format:
horizontal grid, bottom topography, surface forcing,
lateral boundary conditions... He also needs to analyze
the model outputs. The tools which are described here
have been designed to perform these tasks.
The goal is to be able to build a standard
regional model configuration in a minimum time. 

<P>
In the first chapter, the system requirements and the 
installation process are exposed. A short  note on ROMS 
model is presented in chapter 2. A tutorial on the use of
ROMSTOOLS is shown in the third chapter. Tidal simulations, 
inter-annual simulations, nesting tools, biology and
operational regional modeling are presented  in chapter 4, 
5, 6, 7 and 8.

<P>

<H2><A NAME="SECTION00021000000000000000">
1.1 Installation</A>
</H2>

<P>

<H3><A NAME="SECTION00021100000000000000">
1.1.1 System requirement</A>
</H3>

<P>
This toolbox has been designed for Matlab. It needs at least 
2 Gbites of disk space. It has been tested on several 
Matlab versions ranging from Matlab6 to Matlab2006a. It has been 
mostly tested on Linux workstations, but it could be used 
on any platform if a NetCDF and a LoadDAP  Matlab Mex files  
are provided. The NetCDF Matlab Mex file is needed to read 
and write into NetCDF files and it can be found at the web 
location: http://mexcdf.sourceforge.net/. The LoadDAP Matlab Mex file
is used to download data from OpenDAP servers for inter-annual and forecast 
simulations. It can be found at the web location: 
http://www.opendap.org/download/ml-structs.html. The Matlab 
LoadDAP Mex file provides a way to read any OpenDAP-accessible 
data into Matlab. Note that the LibDAP library must be installed
on your system before installing LoadDAP. Details can be found 
at the web location: http://www.opendap.org. MexCDF and LoadDAP mex 
files are provided for Linux (system FEDORA 32bits: mexcdf and 
Opendap_tools/FEDORA ; system CENTOS or FEDORA 64bits: 
mexnc and Opendap_tools/FEDORA_X64), but they are not working 
on all the plateforms.

<P>
All the other necessary Matlab toolboxes (i.e. air-sea, mask, 
netcdf or m_map...) are included in the ROMSTOOLS package. 
Global datasets, such as topography (<A
 HREF="doc.html#Smi97">Smith and Sandwell, 1997</A>), 
hydrography (<A
 HREF="doc.html#Con02">Conkright et al., 2002</A>) or surface fluxes (<A
 HREF="doc.html#Das94">Da Silva et al., 1994</A>), are 
also included.

<P>

<H3><A NAME="SECTION00021200000000000000">
1.1.2 Getting the files</A>
</H3>

<P>
All the necessary compressed tar files (XXX.tar.gz) containing 
the Matlab programs, several datasets  and other toolboxes and 
softwares needed by ROMSTOOLS are located at:
<DIV ALIGN="CENTER">
http://www.brest.ird.fr/Roms_tools/index.html 

</DIV>
For the ROMS source code you should download ROMS_AGRIF version 
V1.1.
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<P>

<H3><A NAME="SECTION00021300000000000000">
1.1.3 Extracting the files</A>
</H3>

<P>
Download all the compressed tar files. Uncompress and untar all 
the files (gunzip and tar -xvf). You should obtain the following 
directory tree : 
<BR>
<BR>Roms_tools

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Aforc_NCEP

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Aforc_QuikSCAT

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- air_sea 

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- COADS05  

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Compile

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Diagnostic_tools

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Documentation

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- User_guide

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Forecast_tools

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- mask

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- mex60

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- mexnc

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- tests

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- m_map

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- private

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Nesting_tools

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- netcdf_g77

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- netcdf_ifc

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- netcdf_matlab

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- listpick

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncatt

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncbrowser

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncdim

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncfiles

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncitem

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncrec

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- nctype

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncutility

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ncvar

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- netcdf

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- netcdf_x86_64

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Oforc_OGCM

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Opendap_tools

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- FEDORA

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- FEDORA_X64

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Preprocessing_tools

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Roms_Agrif

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- AGRIFZOOM

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- AGRIF_FILES

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- AGRIF_INC

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- AGRIF_OBJS

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- AGRIF_YOURFILES

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- LIB.clean

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Run

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- DATA

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- FORECAST

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- ROMS_FILES

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- SCRATCH

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- TEST_CASES

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- SeaWifs

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- SST_pathfinder

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Tides

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Topo

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$"> <IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Matlab

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- TPX06

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- TPX07

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- Visualization_tools

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- WOA2001

<P>
<IMG
 WIDTH="8" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img2.png"
 ALT="$\vert$">- WOA2005

<BR>
<BR>Definition of the different directories :

<UL>
<LI>Aforc_NCEP : Scripts for the recovery of surface forcing data 
      (based on NCEP reanalysis) for inter-annual simulations.
</LI>
<LI>Aforc_QuikSCAT : Scripts for the recovery of wind stress from 
      satellite scatterometer data (QuickSCAT).
</LI>
<LI>COADS05 : Directory of the surface fluxes global monthly 
      climatology at <IMG
 WIDTH="32" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img3.png"
 ALT="$0.5^\circ$"> resolution (<A
 HREF="doc.html#Das94">Da Silva et al., 1994</A>).
</LI>
<LI>Compile : Empty scratch directory for ROMS compilation.
</LI>
<LI>Diagnostic_tools : A few Matlab scripts for animations and
      basic statistical analysis.
</LI>
<LI>Documentation : Location of the ROMSTOOLS user guide.
</LI>
<LI>Forecast_tools : Scripts for the generation of an operational
      modeling system 
</LI>
<LI>mask : Land mask edition toolbox developed by A.Y. Shcherbina.
</LI>
<LI>mex60 : Matlab NetCDF interface for 32 bits Linux architectures.
</LI>
<LI>mexnc : Matlab NetCDF interface for 64 bits Linux architectures.
</LI>
<LI>m_map : The Matlab mapping toolbox 
      (http://www2.ocgy.ubc.ca/<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">rich/map.html).
</LI>
<LI>Nesting_tools : Preprocessing tools used to prepare nested
      models.
</LI>
<LI>netcdf_g77 : The NetCDF Fortran library for Linux, compiled using g77
<BR>      (http://www.unidata.ucar.edu/packages/netcdf/index.html).
</LI>
<LI>netcdf_ifc : The NetCDF Fortran library for Linux, compiled with ifort. 
      The Intel Fortran Compiler (ifort) is available at 
<BR>      http://www.intel.com/software/products/compilers/flin/noncom.htm.
</LI>
<LI>netcdf_matlab : The Matlab NetCDF toolbox  
<BR>      (<FONT SIZE="-1">      http://woodshole.er.usgs.gov/staffpages/cdenham/public_html/MexCDF/nc4ml5.html</FONT>).
</LI>
<LI>netcdf_x86_64 : The NetCDF Fortran library for Linux, compiled with ifort
      on a 64 bits architecture.
</LI>
<LI>Oforc_OGCM : Scripts for the recovery of initial and lateral boundary 
      conditions from global OGCMs (SODA (<A
 HREF="doc.html#Car05">Carton et al., 2005</A>) or ECCO (<A
 HREF="doc.html#Sta99">Stammer et al., 1999</A>)) for 
      inter-annual simulations.
</LI>
<LI>Opendap_tools : LoadDAP mexcdf and several scripts to automatically
      download data over the Internet.
</LI>
<LI>Preprocessing_tools : Preprocessing Matlab scripts (make_grid.m, 
      make_forcing, etc...).
</LI>
<LI>Roms_Agrif : ROMS Fortran sources.
</LI>
<LI>Run : Working directory. This is where the ROMS input files
      are generated and where the model is running.
</LI>
<LI>SeaWifs : surface chlorophyll-a climatology based on SeaWifs observations.
</LI>
<LI>SST_pathfinder : Directory of a higher resolution SST climatology 
      (<A
 HREF="doc.html#Rey94">Reynolds and Smith, 1994</A>) for the thermal correction term.
</LI>
<LI>Tides : Matlab routines to prepare ROMS tidal simulations. Tidal data
      are derived from the Oregon State University global models of ocean tides 
      TPXO6 and TPXO7 (<A
 HREF="doc.html#Egb02">Egbert and Erofeeva, 2002</A>): 
      http://www.oce.orst.edu/research/po/research/tide/global.html.
</LI>
<LI>Topo : Location of the global topography dataset at <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img5.png"
 ALT="$2'$"> resolution
      (<A
 HREF="doc.html#Smi97">Smith and Sandwell, 1997</A>). Original data can be found at:
      http://topex.ucsd.edu/cgi-bin/get_data.cgi
</LI>
<LI>TPX06 : Directory of the global model of ocean tides TPXO6 (<A
 HREF="doc.html#Egb02">Egbert and Erofeeva, 2002</A>).
</LI>
<LI>TPX07 : Directory of the global model of ocean tides TPXO7 (<A
 HREF="doc.html#Egb02">Egbert and Erofeeva, 2002</A>).
</LI>
<LI>Visualization_tools : Matlab scripts for the ROMS visualization
      graphic user interface.
</LI>
<LI>WOA2001 : World Ocean Atlas 2001 global dataset 
      (monthly climatology at <IMG
 WIDTH="19" HEIGHT="14" ALIGN="BOTTOM" BORDER="0"
 SRC="img6.png"
 ALT="$1^\circ$"> resolution) (<A
 HREF="doc.html#Con02">Conkright et al., 2002</A>).
</LI>
<LI>WOA2005 : World Ocean Atlas 2005 global dataset 
</LI>
</UL>

<P>

<H2><A NAME="SECTION00022000000000000000">
1.2 Future plans</A>
</H2>

<UL>
<LI>A graphic user interface could be useful for the preprocessing tools.
</LI>
<LI>There is need for an improvement of the extrapolation and interpolation
methods.
</LI>
</UL>

<P>

<H2><A NAME="SECTION00023000000000000000">
1.3 Warning and bugs</A>
</H2>

<UL>
<LI>Since Geostrophy is used to obtain the horizontal currents for
the lateral boundary conditions, this method should be applied with 
care close to the Equator. An extrapolation of the currents outside 
an equatorial band (2<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">S-2<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">N) is performed to get an 
approximation of the equatorial currents.
</LI>
<LI>On extended grids, the objective analysis used for data 
extrapolation can be relatively costly in memory and CPU time. 
The "nearest" Matlab function that is less costly can be used instead.
If the computer starts to swap, you should think of reducing the 
dimension of your model's domain.
</LI>
<LI>It is sometimes difficult to compile LoadDAP. 
LibDAP must be installed before installing LoadDAP. 
Here are a few instructions for the installation of these libraries:
<BR>
<UL>
<LI>Download libDAP and loadDAP tar.gz version at the web location
http://www.opendap.org
</LI>
<LI>To build the libDAP library, follow these steps:
<BR>
<UL>
<LI>log you as a root
</LI>
<LI>Uncompress and untar the file libdap.tar.gz (gunzip and tar -xvf)
</LI>
<LI><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$">: cd libdap_directory
</LI>
<LI>Type './configure' at the prompt. Some libraries must be installed 
on your system to successfully run configure and build libDAP library : libcurl 
(http://curl.haxx.se/) and libxml2 (http://xmlsoft.org/).
<BR>Example:
<BR>---------------------------------------------
<BR>checking for a BSD-compatible install... /usr/bin/install -c
<BR>checking whether build environment is sane... yes
<BR>checking whether make sets (MAKE)... yes
<BR>checking build system type... i686-pc-linux-gnu
<BR>checking host system type... i686-pc-linux-gnu
<BR>checking for gawk... (cached) mawk
<BR>checking for g++... g++
<BR>checking for C++ compiler default output file name... a.out
<BR>...
<BR>config.status: dods-datatypes.h is unchanged
<BR>config.status: executing depfiles commands
<BR>---------------------------------------------
<BR></LI>
<LI>Type 'make' to build the library.
<BR>Example :
<BR>---------------------------------------------
<BR>make[1]: Entering directory '/home/tropic/tan/soft/libdap-3.6.2'
<BR>Making all in gl
<BR>make[2]: Entering directory '/home/tropic/tan/soft/libdap-3.6.2/gl'
<BR>make  all-am
<BR>make[3]: Entering directory '/home/tropic/tan/soft/libdap-3.6.2/gl'
<BR>...
<BR>---------------------------------------------
<BR></LI>
<LI>Type 'make check' to run the tests. To pass this step you 
must have DejaGNU framework (GNU FTP mirror list:
http://www.gnu.org/prep/ftp.html).
<BR>Example :
<BR>---------------------------------------------
<BR>make[1]: Entering directory `/home/tropic/tan/soft/libdap-3.6.2/gl'
<BR>dejagnu_driver.sh
<BR>...
<BR>Test Run By tan on Thu Jul 19 11:19:02 2007
<BR>Native configuration is i686-pc-linux-gnu
<BR>                ===== das-test tests =====
<BR>		Running ...
<BR>                ===== das-test Summary =====
<BR>                ===== dds-test tests =====
<BR>		Running ...
<BR>		===== dds-test Summary =====
<BR>                ===== expr-test tests =====
<BR>		Running ...
<BR>                ===== expr-test Summary =====
<BR>PASS: dejagnu_driver.sh
<BR>==================
<BR>All 1 tests passed
<BR>==================
<BR>make[2]: Leaving directory `/home/tropic/tan/soft/libdap-3.6.2/tests'
<BR>make[1]: Leaving directory `/home/tropic/tan/soft/libdap-3.6.2/tests'
<BR>---------------------------------------------
<BR></LI>
<LI>Type 'make install' to install the library. By default the files are installed under
/usr/local/lib/. You can specify a different root directory using the following control :
'make install root_directory'.
<BR></LI>
<LI>Go to the .bashrc and add 
<BR>'EXPORT LD_LIBRARY_PATH=$LD_LIBRARY_PATH
: root_directory.'
<BR></LI>
</UL>

<P>
</LI>
<LI>The installation of the loadDAP library is done as for libDAP. 
By default the files are installed under
/usr/local/share/.
</LI>
</UL>
</LI>
</UL>

<P>

<H1><A NAME="SECTION00030000000000000000">
2 The ROMS model</A>
</H1>
ROMS solves the primitive equations in an Earth-centered
rotating environment, based on the Boussinesq approximation and
hydrostatic vertical momentum balance. ROMS is discretized in
coastline- and terrain-following curvilinear coordinates.
ROMS is a split-explicit, free-surface ocean model, where short time steps
are used to advance the surface elevation and barotropic momentum, with a
much larger time step used for temperature, salinity, and baroclinic momentum.
ROMS employs a special 2-way time-averaging procedure for the barotropic mode,
which satisfies the 3D continuity equation (<A
 HREF="doc.html#Shc03b">Shchepetkin and McWilliams, 2005</A>).
The specially designed predictor-corrector time step algorithm used in ROMS
allows a substantial increase in the permissible time-step size.

<P>
ROMS has been designed to be optimized on shared memory parallel computer
architectures such as the SGI/CRAY Origin 2000. Parallelization is done
by two dimensional sub-domains partitioning. Multiple sub-domains can be
assigned to each processor in order to optimize the use of processor
cache memory. This allow super-linear scaling when performance growth even
faster than the number of CPUs.

<P>
The third-order, upstream-biased advection scheme implemented in ROMS
allows the generation of steep gradients, enhancing the effective resolution
of the solution for a given grid size (<A
 HREF="doc.html#Shc98">Shchepetkin and McWilliams, 1998</A>). Explicit lateral
viscosity is null everywhere in the model domain except in sponge layers
near the open  boundaries where it increases smoothly close to the lateral
open boundaries.

<P>
A non-local, K-profile planetary (KPP) boundary layer scheme (<A
 HREF="doc.html#Lar94">Large, 1994</A>)
parameterizes the unresolved physical vertical subgrid-scale processes.
If a lateral boundary faces the open ocean, an active, implicit,
upstream biased, radiation condition connects the model solution
to the surroundings (<A
 HREF="doc.html#Mar01">Marchesiello et al., 2001</A>).

<P>

<H1><A NAME="SECTION00040000000000000000">
3 Tutorial : the Southern Benguela example</A>
</H1>
This section presents the essential steps for preparing
and running a regional ROMS simulation. This is 
done following the example of a model of the
Southern Benguela at low resolution.

<P>

<H2><A NAME="SECTION00041000000000000000">
3.1 Getting started</A>
</H2>

<P>
Once the installation has been successful, launch a Matlab session
in the directory: <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run. Run the start.m
script to set the Matlab paths for this session. The start.m script
also makes the difference between 32 bits and 64 bits Linux architectures
and adjusts the paths in consequence: 
<BR>
<BR><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> : cd Roms_tools/Run 
<BR><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> : matlab 
<BR><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img9.png"
 ALT="$&lt;$"> M A T L A B <IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$">...
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> start 
<BR>Add the paths of the different toolboxes... 
<BR>Arch : x86_64 - Matlab version : 12 
<BR>Use of mex60 and loaddap in 32 bits. 
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> 
<BR>
<BR>You are now ready to create a new configuration.
It is important to respect the order of the following preprocessing 
steps: make_grid, make_forcing, make_clim.
For all the preprocessing steps, there is only one file to edit : 
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/romstools_param.m .
This file contains the necessary parameters for the generation
of the ROMS input NetCDF files.
The first section in romstools_param.m  defines the general parameters,
such as title, working directories or file names:

<BR>
<BR>%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% 1- General parameters
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>%  ROMS title names and directories
<BR>%
<BR>ROMS_title  = 'Benguela Test Model';
<BR>ROMS_config = 'Benguela';
<BR>ROMSTOOLS_dir = '../';
<BR>RUN_dir=[ROMSTOOLS_dir,'Run/'];
<BR>ROMS_files_dir=[RUN_dir,'ROMS_FILES/'];
<BR>%
<BR>% ROMS file names (grid, forcing, bulk, climatology, initial)
<BR>%
<BR>grdname=[ROMS_files_dir,'roms_grd.nc'];
<BR>frcname=[ROMS_files_dir,'roms_frc.nc'];
<BR>blkname=[ROMS_files_dir,'roms_blk.nc'];
<BR>clmname=[ROMS_files_dir,'roms_clm.nc'];
<BR>ininame=[ROMS_files_dir,'roms_ini.nc'];
<BR>oaname =[ROMS_files_dir,'roms_oa.nc'];    % oa file  : intermediate file not used
<BR>                                          %            in roms simulations
<BR>bryname=[ROMS_files_dir,'roms_bry.nc'];
<BR>Zbryname=[ROMS_files_dir,'roms_bry_Z.nc'];% Zbry file: intermediate file not used
<BR>                                          %            in roms simulations
<BR>%
<BR>frc_prefix=[ROMS_files_dir,'roms_frc'];   % generic bulk forcing file name 
<BR>                                          % for inter-annual roms simulations (NCEP or GFS)
<BR>blk_prefix=[ROMS_files_dir,'roms_blk'];   % generic forcing file name
<BR>                                          % for inter-annual roms simulations (NCEP or GFS)
<BR>%
<BR>% Objective analysis decorrelation scale [m]
<BR>% (if Roa=0: simple extrapolation method; crude but much less costly)
<BR>%
<BR>%Roa=300e3;
<BR>Roa=0;
<BR>%
<BR>interp_method = 'cubic';           % Interpolation method: 'linear' or 'cubic'
<BR>%
<BR>makeplot     = 1;                 % 1: create a few graphics after each preprocessing step
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>
<BR>Variables description:

<UL>
<LI>title='Benguela Test Model' : General title. You can give any name 
you want for your configuration.
</LI>
<LI>ROMS_config = 'Benguela' : Name of the configuration. This is used for the storage of
NCEP or OGCM data for a specific configuration.
</LI>
<LI>ROMSTOOLS_dir = '../' : "Roms_tools" directory.
</LI>
<LI>RUN_dir=[ROMSTOOLS_dir,'Run/'] : Roms_tools/Run directory. This is where all 
the work is done.
</LI>
<LI>ROMS_files_dir=[RUN_dir,'ROMS_FILES/'] : Roms_tools/Run/ROMS_FILES/ directory.
This is where ROMS input NetCDF files are stored.
</LI>
<LI>grdname=[ROMS_files_dir,'roms_grd.nc'] : Name of the ROMS input NetCDF grid file.
This is where the horizontal grid parameters are stored. In general, we follow 
the style : XXX_grd.nc.
</LI>
<LI>frcname=[ROMS_files_dir,'roms_frc.nc'] : : Name of the ROMS input NetCDF forcing file.
This is where the surface forcing variables (such as wind stress) are stored. In general, we 
follow  the style : XXX_frc.nc.
</LI>
<LI>blkname=[ROMS_files_dir,'roms_blk.nc'] : Name of the ROMS input NetCDF bulk file.
This is where the atmospheric variables used for the bulk parametrization (such as air temperature) 
are stored. In general, we follow  the style : XXX_blk.nc.
</LI>
<LI>clmname=[ROMS_files_dir,'roms_clm.nc'] : Name of the ROMS input NetCDF climatology file.
This is where ROMS prognostic variables (u,v, temp, salt, ubar, vbar, zeta) for lateral boundary 
and interior nudging are stored. This file can be large because variables are stored for all the 
ROMS grid interior points. It is called "a climatology file" because this was the file used in 
the past for the restoring of the ROMS solution towards an in-situ climatology (such as Levitus 
for example). In general, we follow the style : XXX_clm.nc.
</LI>
<LI>ininame=[ROMS_files_dir,'roms_ini.nc'] : Name of the ROMS input NetCDF initial file.
This is where ROMS prognostic variables (u,v, temp, salt, ubar, vbar, zeta) are stored 
for the initial conditions. In general, we follow the style : XXX_ini.nc.
</LI>
<LI>oaname =[ROMS_files_dir,'roms_oa.nc'] : Name of an intermediate file which is not
used by ROMS. This is equivalent to the climatology file, but on a z vertical coordinate.
Firstly, the variables are horizontally interpolated to create a roms_oa.nc file (a OA file). 
Then, they are vertically interpolated on the ROMS s-coordinate for the climatology
file. In general, we follow the style : XXX_oa.nc.
</LI>
<LI>bryname=[ROMS_files_dir,'roms_bry.nc'] : Name of the ROMS input NetCDF boundary file.
This is an alternative of the climatology file. In this case, variables are only stored for 
the lateral boundaries. In general, we follow the style : XXX_bry.nc.
</LI>
<LI>Zbryname=[ROMS_files_dir,'roms_bry_Z.nc'] : Intermediate file on a z coordinate
for the boundary file. In general, we follow the style : XXX_bry_Z.nc.
</LI>
<LI>frc_prefix=[ROMS_files_dir,'roms_frc'] : First part of the forcing file names in
the case of inter_annual simulations. In this case, a separate file is created for each month.
For example, a forcing file based on NCEP for January 2000 is : roms_frc_NCEP_Y2000M1.nc
</LI>
<LI>blk_prefix=[ROMS_files_dir,'roms_blk'] : First part of the bulk file names in
the case of inter_annual simulations. In this case, a separate file is created for each month.
For example, a bulk file based on NCEP for January 2000 is : roms_blk_NCEP_Y2000M1.nc
</LI>
<LI>Roa=0 : Decorrelation length scale in meters for the objective analysis (300 km
is a reasonable value for the employed datasets). If Roa=0, the "nearest" Matlab extrapolation
method is used instead of an objective analysis. This is much less costly, but the 
results might be at a lower quality.
</LI>
<LI>interp_method = 'cubic' : Horizontal interpolation method used after the objective 
analysis. It can be linear or cubic.
</LI>
<LI>makeplot     = 1 : Select to generate images after each step of the preprocessing.
</LI>
</UL>

<P>

<H2><A NAME="SECTION00042000000000000000">
3.2 Building the grid</A>
</H2>

<P>
The part of the file romstools_param.m that you should edit is :

<BR>
<BR>%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% 2-Grid parameters
<BR>%   used by make_grid.m (and others..)
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% Grid dimensions:
<BR>%
<BR>lonmin =  12.3;   % Minimum longitude [degree east]
<BR>lonmax = 20.45;   % Maximum longitude [degree east]
<BR>latmin = -35.5;   % Minimum latitude  [degree north]
<BR>latmax = -26.5;   % Maximum latitude  [degree north]
<BR>%
<BR>% Grid resolution [degree]
<BR>%
<BR>dl = 1/3;
<BR>%
<BR>% Number of vertical Levels (! should be the same in param.h !)
<BR>%
<BR>N = 32;
<BR>%
<BR>%  Vertical grid parameters (! should be the same in roms.in !)
<BR>%
<BR>theta_s = 6.;
<BR>theta_b = 0.;
<BR>hc      =10.;
<BR>%
<BR>% Minimum depth at the shore [m] (depends on the resolution,
<BR>% rule of thumb: dl=1, hmin=300, dl=1/4, hmin=150, ...)
<BR>% This affect the filtering since it works on grad(h)/h.
<BR>%
<BR>hmin = 75;
<BR>%
<BR>% Maximum depth at the shore [m] (to prevent the generation
<BR>% of too big walls along the coast)
<BR>%
<BR>hmax_coast = 500;
<BR>%
<BR>%  Topography netcdf file name (ETOPO 2 or any other netcdf file
<BR>%  in the same format)
<BR>%
<BR>topofile = [ROMSTOOLS_dir,'Topo/etopo2.nc'];
<BR>%
<BR>% Slope parameter (r=grad(h)/h) maximum value for topography smoothing
<BR>%
<BR>rtarget = 0.25;
<BR>%
<BR>% Number of pass of a selective filter to reduce the isolated
<BR>% seamounts on the deep ocean.
<BR>%
<BR>n_filter_deep_topo=4;
<BR>%
<BR>% Number of pass of a single hanning filter at the end of the
<BR>% smoothing procedure to ensure that there is no 2DX noise in the 
<BR>% topography.
<BR>%
<BR>n_filter_final=2;
<BR>%
<BR>%  GSHSS user defined coastline (see m_map) 
<BR>%  XXX_f.mat    Full resolution data
<BR>%  XXX_h.mat    High resolution data
<BR>%  XXX_i.mat    Intermediate resolution data
<BR>%  XXX_l.mat    Low resolution data
<BR>%  XXX_c.mat    Crude resolution data
<BR>%
<BR>coastfileplot = 'coastline_l.mat';
<BR>coastfilemask = 'coastline_l_mask.mat';
<BR>
<BR>Variables description:

<UL>
<LI>lonmin =  12.3 : Western limit of the grid in longitude [-360<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">, 360<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">]. 
The grid is rectangular in latitude/longitude.
</LI>
<LI>lonmax = 20.45 : Eastern limit [-360<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">, 360<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">]. 
Should be superior to lonmin.
</LI>
<LI>latmin = -35.5 : Southern limit of the grid in latitude [-90<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">, 90<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">].
</LI>
<LI>latmax = -26.5 : Northern limit [-90<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">, 90<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">].
Should be superior to latmin.
</LI>
<LI>l = 1/3 : Grid longitude resolution in degrees. The latitude spacing is deduced to
obtain an isotropic grid using the relation: <!-- MATH
 $d\phi=dl\cos(\phi)$
 -->
<IMG
 WIDTH="102" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img11.png"
 ALT="$d\phi=dl\cos(\phi)$">.
</LI>
<LI>N = 32 : Number of vertical levels. Warning! N has to be also 
defined in the file : <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/param.h before compiling
the model.
</LI>
<LI>theta_s = 6. : Vertical S-coordinate surface stretching parameter. 
When building the climatology and initial ROMS files, we have to define
the vertical grid. Warning! The different vertical grid parameters should 
be identical in this file and in the ROMS input file (i.e. 
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/roms.in).
This is a serious cause of bug.
The effects of theta_s, theta_b, hc, and N can be tested 
using the Matlab script : 
<BR><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Preprocessing_tools/test_vgrid.m.
</LI>
<LI>theta_b = 0. : Vertical S-coordinate bottom stretching parameter.
</LI>
<LI>hc      = 10. : Vertical S-coordinate <IMG
 WIDTH="24" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img12.png"
 ALT="$H_c$"> parameter. It gives approximately the
transition depth between the horizontal surface levels and the bottom terrain following
levels. It should be inferior to hmin.
</LI>
<LI>hmin = 75 : Minimum depth in meters. The model depth is cut a this level 
to prevent, for example, the occurrence of model grid cells without water.
This does not influence the masking routines. At lower resolution, hmin should be 
quite large (for example 150m for dl=1/2). Otherwise, since topography smoothing 
is based on <!-- MATH
 $\frac{\nabla h}{2h}$
 -->
<IMG
 WIDTH="26" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img13.png"
 ALT="$\frac{\nabla h}{2h}$">, the bottom slopes can be totally eroded.
</LI>
<LI>hmax_coast = 500 : Maximum depth under the mask. It prevents selected
isobaths (here 500 m) to go under the mask. If this is the case, 
this could be a source of problems
for western boundary currents (for example).
</LI>
<LI>topofile = [ROMSTOOLS_dir,'Topo/etopo2.nc'] : Default topography file. 
We are using here etopo2 (<A
 HREF="doc.html#Smi97">Smith and Sandwell, 1997</A>). 
</LI>
<LI>rtarget = 0.25 : This variable control the maximum value of the <IMG
 WIDTH="12" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img14.png"
 ALT="$r$">-parameter
that measures the slope of the sigma layers (<A
 HREF="doc.html#Bec93">Beckmann and Haidvogel, 1993</A>):
<BR><P></P>
<DIV ALIGN="CENTER">
<!-- MATH
 \begin{displaymath}
r=\frac{\nabla h}{2h}=\frac{h_{+1/2}-h_{-1/2}}{h_{+1/2}+h_{-1/2}}
\end{displaymath}
 -->

<IMG
 WIDTH="176" HEIGHT="46" BORDER="0"
 SRC="img15.png"
 ALT="\begin{displaymath}
r=\frac{\nabla h}{2h}=\frac{h_{+1/2}-h_{-1/2}}{h_{+1/2}+h_{-1/2}}
\end{displaymath}">
</DIV><BR CLEAR="ALL">
<P></P>
To prevent horizontal pressure gradients errors, well known in
terrain-following coordinate models (<A
 HREF="doc.html#Han91">Haney, 1991</A>), realistic topography
requires some smoothing. Empirical results have shown that reliable
model results are obtained if <IMG
 WIDTH="12" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img14.png"
 ALT="$r$"> does not exceed 0.2.
</LI>
<LI>n_filter_deep_topo=4 : Number of pass of a Hanning filter to prevent 
the occurrence of noise and isolated seamounts on deep regions.
</LI>
<LI>n_filter_final=2 : Number of pass of a Hanning filter at the end of the
smoothing process to be sure that no noise is present in the topography.
</LI>
<LI>coastfileplot = 'coastline_l.mat' : Binary GSHSS coastal file used by m_map
for graphical pruposes. The letter before ".mat" selects the coastline resolution.
f: Full resolution, h: High resolution, i: Intermediate resolution, l: Low resolution
c: Crude resolution.
</LI>
<LI>coastfilemask = 'coastline_l_mask.mat' :  Binary file used
for the coastline in the masking toolbox.
</LI>
</UL>

<P>
Save romstools_param.m and run make_grid in the Matlab session :

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_grid 
<BR> 
<BR>You should obtain in the Matlab session:
<BR>---------------------------------------------
<BR>Making the grid: ../Run/ROMS_FILES/roms_grd.nc 
<BR>
<BR>Title: Benguela Test Model 
<BR>
<BR>Resolution: 1/3 deg 
<BR>
<BR>Create the grid file... 
<BR>LLm = 23 
<BR>MMm = 31 
<BR>
<BR>Fill the grid file... 
<BR>
<BR>Compute the metrics... 
<BR>
<BR>Min dx=30.1583 km - Max dx=33.1863 km 
<BR>Min dy=30.2091 km - Max dy=33.057 km 
<BR>
<BR>Fill the grid file... 
<BR>
<BR>Add topography... 
<BR>  ROMS resolution : 31.7 km 
<BR>  Topography data resolution : 3.44 km 
<BR>  Topography resolution halved 4 times 
<BR>   New topography resolution : 54.8 km 
<BR>Processing coastline_l.mat ... 
<BR>Do you want to use editmask ? y,[n]
<BR> Apply a filter on the Deep Ocean to remove the isolated seamounts :
<BR>   4 pass of a selective filter.
<BR> Apply a selective filter on log(h) to reduce grad(h)/h :
<BR>   13 iterations - rmax = 0.24879
<BR> Smooth the topography a last time to prevent 2DX noise:
<BR>   2 pass of a hanning smoother.
<BR> Write it down...
<BR> Do a plot...
<BR> <IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR> ---------------------------------------------
<BR>
<BR>You should keep the values of LLm and MMm during the process.
They will be necessary for the ROMS parameter file  
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/param.h. In this test case,
LLm0 = 23 and MMm0 = 31. 

<P>
During the grid generation process, the question 
"Do you want to use editmask ? y,[n]" is asked. The default answer is n (for no).
If the answer is y (for yes), editmask, the  graphic interface developed 
by A.Y.Shcherbina, will be launched to manually edit the mask 
(Note that, for the moment, editmask is not working with matlab7 and mexnc).
Otherwise the
mask is generated from the unfiltered topography data. A procedure prevents 
the existence of isolated land (or sea) points.

<P>
Figure (<A HREF="#fig:grid">1</A>) presents the
bottom topography obtained with make_grid.m for the
Southern Benguela example. Note that at this low
resolution (1/3<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">), the topography has been strongly
smoothed.

<P>

<DIV ALIGN="CENTER"><A NAME="fig:grid"></A><A NAME="506"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 1:</STRONG>
Result of make_grid.m for the Benguela example</CAPTION>
<TR><TD><IMG
 WIDTH="271" HEIGHT="359" BORDER="0"
 SRC="img16.png"
 ALT="\begin{figure}\centerline{\psfig{figure=make_grid_benguela.eps,width=6cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<H2><A NAME="SECTION00043000000000000000">
3.3 Getting the wind and other surface fluxes</A>
</H2>

<P>
The next step is to create the file containing the different surface
fluxes. The part of the file romstools_param.m that you should edit is :

<BR>
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>% 3-Surface forcing parameters
<BR>%   used by make_forcing.m and by make_bulk.m
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>% COADS directory (for climatology runs)
<BR>%
<BR>coads_dir=[ROMSTOOLS_dir,'COADS05/'];
<BR>%
<BR>% COADS time (for climatology runs)
<BR>%
<BR>coads_time=(15:30:345); % days: middle of each month
<BR>coads_cycle=360;        % repetition of a typical year of 360 days 
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% 3.1 Surface forcing parameters
<BR>%   used by pathfinder_sst.m
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>pathfinder_sst_name=[ROMSTOOLS_dir,...
<BR>                    'SST_pathfinder/climato_pathfinder.nc'];
<BR>
<BR>Variables description:

<UL>
<LI>coads_dir=[ROMSTOOLS_dir,'COADS05/'] : Directory where the global atlas of surface marine 
data at 1/2<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$"> resolution (<A
 HREF="doc.html#Das94">Da Silva et al., 1994</A>) is located.
</LI>
<LI>coads_time=(15:30:345) : Time in days for the monthly climatology. It corresponds to the
middle of each month. ROMS uses this time to interpolate linearly the forcing variables in time.
</LI>
<LI>coads_cycle=360 : Duration on which the forcing variables are cycled. Here, for the sake
of simplicity, we are running the model on a repeating climatological year of 360 days.
</LI>
<LI>pathfinder_sst_name=[ROMSTOOLS_dir,SST_pathfinder/climato_pathfinder.nc'] : 
Directory of the  monthly climatology of sea surface temperature from Pathfinder satellite 
observations (<A
 HREF="doc.html#Cas99">Casey and Cornillon, 1999</A>). This can be used has an alternative of <A
 HREF="doc.html#Das94">Da Silva et al. (1994)</A> SST.
</LI>
</UL>

<P>
Save romstools_param.m and run make_forcing in the Matlab session :

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_forcing
<BR>
<BR>You should obtain :
<BR>---------------------------------------------
<BR>Benguela Test Model
<BR>
<BR> Read in the grid...
<BR>
<BR> Create the forcing file...
<BR>Getting taux for time index 1
<BR>Getting tauy for time index 1
<BR>...
<BR>Make a few plots...
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR>---------------------------------------------
<BR>
<BR>This program can take a relatively long time to process all the forcing variables.
Figure (<A HREF="#fig:forcing">2</A>) presents the wind stress vectors and wind stress norm 
obtained from the global atlas of surface marine 
data at 1/2<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$"> resolution (<A
 HREF="doc.html#Das94">Da Silva et al., 1994</A>) at 4 different periods of the year.
<A
 HREF="doc.html#Das94">Da Silva et al. (1994)</A> sea surface temperature (SST) is used for the restoring term (dQdSST)
in the heat flux calculation. To improve the model solution it is possible to 
use a SST climatology at a finer resolution (9.28 km) (<A
 HREF="doc.html#Cas99">Casey and Cornillon, 1999</A>). To do 
so, you can run pathfinder_sst.m in the Matlab session :

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> pathfinder_sst
<BR>
<BR>
<BR>
<BR>You should obtain :
<BR>---------------------------------------------
<BR> ... Month index: 1 
<BR> ... Month index: 2 
<BR>...
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR>---------------------------------------------
<BR>
<BR>For the surface forcing, instead of directly prescribing the fluxes, it is possible 
to use a bulk formula to generate the surface fluxes from atmospheric variables 
during the model run. In this case, ROMS needs to be recompiled with the BULK_FLUX
cpp key defined. To generate the bulk forcing file, you need to run make_bulk
in the Matlab session :

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_bulk
<BR>
<BR>You should obtain :
<BR>---------------------------------------------
<BR>Benguela Test Model
<BR>
<BR> Read in the grid...
<BR>
<BR> Create the bulk forcing file...
<BR>Getting sat for time index 1
<BR>Getting sat for time index 2
<BR>...
<BR>Make a few plots...
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR>---------------------------------------------
<BR>
<P>

<DIV ALIGN="CENTER"><A NAME="fig:forcing"></A><A NAME="617"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 2:</STRONG>
Wind stress[N.m<IMG
 WIDTH="21" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img1.png"
 ALT="$^{-2}$">] obtained using make_forcing.m for the Benguela example.</CAPTION>
<TR><TD><IMG
 WIDTH="409" HEIGHT="335" BORDER="0"
 SRC="img17.png"
 ALT="\begin{figure}\centerline{\psfig{figure=make_frcwind_benguela.eps,width=9cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<H2><A NAME="SECTION00044000000000000000">
3.4 Getting the initial and the lateral boundary conditions</A>
</H2>

<P>
The last preprocessing step consists in generating the files containing 
the necessary informations for the ROMS initial and lateral open boundaries 
conditions.
This script generates two files : the climatology file (XXX_clm.nc) which gives 
the lateral boundary conditions, and the initial conditions file (XXX_ini.nc).
The part which should be edited by the user in the file romstools_param.m is:

<BR>
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% 4-Open boundaries and initial conditions parameters
<BR>%   used by make_clim.m, make_biol.m, make_bry.m
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%  Open boundaries switches (! should be consistent with cppdefs.h !)
<BR>%
<BR>obc = [1 1 1 1]; % open boundaries (1=open , [S E N W])
<BR>%
<BR>%  Level of reference for geostrophy calculation
<BR>%
<BR>zref = -1000;
<BR>%
<BR>%  Switches for selecting what to process in make_clim (1=ON)
<BR>%  (and also in make_OGCM.m and make_OGCM_frcst.m)
<BR>makeini=1;      %1: process initial data
<BR>makeclim=1;     %1: process lateral boundary data
<BR>makebry=0;      %1: process boundary data
<BR>%
<BR>makeoa=1;       %1: process oa data (intermediate file)
<BR>makeZbry=0;     %1: process data in Z coordinate
<BR>%
<BR>insitu2pot=1;   %1: convert in-situ temperature into potential temperature
<BR>%
<BR>%  Day of initialization for climatology experiments (=0 : 1st January 0h)
<BR>%
<BR>tini=0;
<BR>%
<BR>% World Ocean Atlas directory (WOA2001 or WOA2005) 
<BR>%
<BR>woa_dir=[ROMSTOOLS_dir,'WOA2005/'];
<BR>%
<BR>% Surface chlorophyll seasonal climatology (WOA2001 or SeaWifs)
<BR>%
<BR>chla_dir=[ROMSTOOLS_dir,'SeaWifs/'];
<BR>%
<BR>%  Set times and cycles for the boundary conditions:
<BR>%   monthly climatology 
<BR>%
<BR>woa_time=(15:30:345); % days: middle of each month
<BR>woa_cycle=360;        % repetition of a typical year of 360 days
<BR>%
<BR>
<P>
Variables description:

<UL>
<LI>obc=[1 1 1 1] : Switches to open (1=open) or close (0=wall) the lateral
boundaries [South East North West]. This is used for the application of mass
enforcement. Be aware, this should be compatible with the open boundary
CPP-switches in the file <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/cppdefs.h.
</LI>
<LI>zref=-1000 : Depth [meters] of the level of no motion for the geostrophic 
velocities calculation.
</LI>
<LI>makeini=1 : Switch to define if the initial file (roms_ini.nc) is generated. 
Should be 1.
</LI>
<LI>makeclim=1 : Switch to define if the climatology
 (lateral boundary conditions) file (roms_clm.nc) is generated. Should be 1.
</LI>
<LI>makeoa=1 : Switch to define if the OA (objective analysis; roms_oa.nc)
 file is generated. This should be 1. The OA files are intermediate files
 where hydrographic data are stored on a ROMS horizontal grid but on
 a z vertical grid. The transformation into S-coordinate is done later.
 This file is not used by ROMS.
</LI>
<LI>makebry=1 : Switch to define if the boundary file (roms_bry.nc) is generated.
Used only with make_bry.
</LI>
<LI>makeZbry=1  :Switch to define if the boundary intermediate file on a z coordinate 
 (roms_bry_Z.nc) is generated. Used only with make_bry.
</LI>
<LI>insitu2pot=1 : Switch defined if it is in-situ temperature that is provided.
In this case, in-situ temperature is converted into potential temperature.
</LI>
<LI>tini=0 : Day of initialization in climatology experiments (15 = January 15).
</LI>
<LI>woa_dir=[ROMSTOOLS_dir,'WOA2005/'] : Directory where the World Ocean
Atlas 2005 climatology (<A
 HREF="doc.html#Con02">Conkright et al., 2002</A>) is located. The World Ocean
Atlas 2001 climatology can also be used.
</LI>
<LI>chla_dir=[ROMSTOOLS_dir,'SeaWifs/'] : Directory of the surface 
chlorophyll seasonal climatology.
</LI>
<LI>woa_time=(15:30:345) : Time in days for the WOA monthly climatology. 
It corresponds to the middle of each month. ROMS uses this variable to 
interpolate linearly the climatology variables in time.
</LI>
<LI>woa_cycle=360 : Duration on which the climatology variables are cycled. 
Here, for the sake of simplicity, we are running the model on a repeating climatological 
year of 360 days.
</LI>
</UL>
Save romstools_param.m and run make_clim in the Matlab session :

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_clim 
<BR>
<BR>You should obtain :
<BR>---------------------------------------------
<BR> Making the clim: ../Run/ROMS_FILES/roms_clm.nc 
<BR> 
<BR> Title: Benguela Test Model 
<BR> 
<BR> Read in the grid...
 
<BR> Create the climatology file... 
<BR> Creating the file : ../Run/ROMS_FILES/roms_clm.nc
<BR> ...
<BR> Make a few plots...
<BR> <IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR>---------------------------------------------
<BR>
<BR>This program can also take quite a long time to run.
Figure (<A HREF="#fig:clim">3</A>) presents 4 different sections
of temperature for the initial condition file for the 
Benguela example. The sections are in the X-direction (East-West), 
the first section is for the Southern part of the domain and the last one 
is for the Northern part of the domain.

<DIV ALIGN="CENTER"><A NAME="fig:clim"></A><A NAME="531"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 3:</STRONG>
Result of make_clim.m for the Benguela example</CAPTION>
<TR><TD><IMG
 WIDTH="318" HEIGHT="249" BORDER="0"
 SRC="img18.png"
 ALT="\begin{figure}\centerline{\psfig{figure=make_clim_benguela.eps,width=7cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
An alternative of using a climatology file is to create a boundary 
file. In this case, only boundary values are stored. The cpp key
FRC_BRY should be defined and ROMS recompiled. Run make_bry in 
the Matlab session :

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_bry 
<BR>
<BR>You should obtain :
<BR>---------------------------------------------
<BR> Making the file: ../Run/ROMS_FILES/roms_bry.nc 
<BR> 
<BR> Title: Benguela Test Model 
<BR> 
<BR> Read in the grid... 
<BR>... 
<BR>---------------------------------------------
<BR>
<P>

<H2><A NAME="SECTION00045000000000000000">
3.5 Compiling the model</A>
</H2>

<P>
Once all the netcdf data files are ready (i.e. XXX_grd.nc,
XXX_frc.nc, XXX_ini.nc, and XXX_clm.nc), we can 
prepare ROMS for compilation. All is done in the 
 <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ directory. 

<P>

<H3><A NAME="SECTION00045100000000000000">
3.5.1 param.h</A>
</H3>
Edit the file 
 <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/param.h.
 The line which needs to be changed is:
<BR>
<BR>#  elif defined BENGUELA

<P>
parameter (LLm0=23, MMm0=31, N=32)  ! <IMG
 WIDTH="46" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img19.png"
 ALT="$&lt;--$"> Southern Benguela Test Case
<BR>#  else
<BR>
<BR>These are the values of the model grid size: LLm0 points in the X 
direction, MMm0 points in the Y direction and N vertical levels.
LLm0 and MMm0 are given by running make_grid.m, and N is
defined in romstools_param.m.

<P>

<H3><A NAME="SECTION00045200000000000000">
3.5.2 cppdefs.h</A>
</H3>
The second file to edit is  <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/cppdefs.h.
This file defines the CPP keys that are used by the
the C-preprocessor when compiling ROMS. The C-preprocessor selects the different
parts of the Fortran code which needs to be compiled depending on the defined CPP
options. These options are separated in two parts (the basic option keys and
the advanced options keys) in cppdefs.h.
<BR>
<P>
Definitions of the CCP keys in cppdefs.h:

<UL>
<LI>BASIN     : Must be defined for running the Basin Example.
</LI>
<LI>CANYON_A  : Must be defined for running the Canyon_A Example.
</LI>
<LI>CANYON_B  : Must be defined for running the Canyon_B Example.
</LI>
<LI>GRAV_ADJ  : Must be defined for running the Gravitational Adjustment Example.
</LI>
<LI>INNERSHELF   : Must be defined for running the Inner Shelf Example.
</LI>
<LI>OVERFLOW  : Must be defined for running the Gravitational/Overflow Example.
</LI>
<LI>SEAMOUNT  : Must be defined for running the Seamount Example.
</LI>
<LI>SHELFRONT : Must be defined for running the Shelf Front Example.
</LI>
<LI>SOLITON   : Must be defined for running the Equatorial Rossby Wave Example.
</LI>
<LI>UPWELLING : Must be defined for running the Upwelling Example.
</LI>
<LI>VORTEX    : Must be defined for running the Baroclinic Vortex Example  
</LI>
<LI>REGIONAL  : Must be defined if running realistic regional simulations.

<BR>
<BR>
<BR>
<BR>
<BR>-------------
<BR>       BASIC OPTIONS 
<BR>-------------

<BR>
<BR>/*                       Configuration Name */
</LI>
<LI>BENGUELA :  Configuration Name, this is used in param.h.

<BR>
<BR>/*                       Parallelization */
</LI>
<LI>OPENMP : Activate the Open-MP parallelization protocol.
</LI>
<LI>MPI : Activate the MPI parallelization protocol.

<BR>
<BR>/*                       Embedding */
</LI>
<LI>AGRIF : Activate the nesting capabilities

<BR>
<BR>/*                       Open Boundary Conditions */
</LI>
<LI>TIDES  : Force tidal currents at the lateral boundaries.
</LI>
<LI>OBC_EAST : Open eastern boundary (should be consistent with make_clim.m).
</LI>
<LI>OBC_WEST : Open western boundary (should be consistent with make_clim.m).
</LI>
<LI>OBC_NORTH : Open northern boundary (should be consistent with make_clim.m).
</LI>
<LI>OBC_SOUTH : Open southern boundary (should be consistent with make_clim.m).

<BR>
<BR>/*                       Embedding conditions */
</LI>
<LI>AGRIF_OBC_EAST  : Open eastern boundary for the child grids.
</LI>
<LI>AGRIF_OBC_WEST   : Open western boundary for the child grids.
</LI>
<LI>AGRIF_OBC_NORTH   : Open northern boundary for the child grids.
</LI>
<LI>AGRIF_OBC_SOUTH   : Open southern boundary for the child grids.

<BR>
<BR>/*                       Applications */
</LI>
<LI>BIOLOGY : Activate the biogeochemical module. 
</LI>
<LI>FLOATS : Activate floats.
</LI>
<LI>STATIONS : Store model outputs for each time step at different station locations.
</LI>
<LI>PASSIVE_TRACER : Add a passive tracer.
</LI>
<LI>SEDIMENT : Activate the sediment module.
</LI>
<LI>BBL : Activate the bottom boundary layer module.

<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<BR>----------------------
<BR>   MORE ADVANCED OPTIONS 
<BR>----------------------

<BR>
<BR>/*                       Model dynamics */
</LI>
<LI>SOLVE3D : Define if solving 3D primitive equations.
</LI>
<LI>UV_COR : Activate Coriolis terms.
</LI>
<LI>UV_ADV : Activate advection terms.
</LI>
<LI>SSH_TIDES : Define for processing sea surface elevation tidal data at the model boundaries.
</LI>
<LI>UV_TIDES :  Define for processing ocean current tidal data at the model boundaries.
</LI>
<LI>TIDERAMP  :  Apply a ramping of the tidal current, (in general 2 days) at initialization.
Warning! This should be off when restarting the model.

<BR>
<BR>/*                       Grid configuration */
</LI>
<LI>CURVGRID : Activate curvilinear coordinate grid option.
</LI>
<LI>SPHERICAL : Activate longitude/latitude grid positioning.
</LI>
<LI>MASKING : Activate land masking in the domain.

<BR>
<BR>/*                       Input/Output and Diagnostics */
</LI>
<LI>AVERAGES : Define if writing out time-averaged data.
</LI>
<LI>AVERAGES_K : Define if writing out time-averaged vertical mixing.
</LI>
<LI>DIAGNOSTICS_TS  : Define if writing out tendency terms for the tracer equations.
</LI>
<LI>DIAGNOSTICS_UV  : Define if writing out tendency terms for the momentum equations.

<BR>
<BR>/*                       Equation of State */
</LI>
<LI>SALINITY : Define if using salinity.
</LI>
<LI>NONLIN_EOS : Activate the nonlinear equation of state.
</LI>
<LI>SPLIT_EOS : Activate the split of the nonlinear equation of state in a
adiabatic part and a compressible part for the reduction of pressure gradient errors
(<A
 HREF="doc.html#Shc03a">Shchepetkin and McWilliams, 2003</A>).

<BR>
<BR>/*                       Surface Forcing */
</LI>
<LI>QCORRECTION : Activate net heat flux correction.
</LI>
<LI>SFLX_CORR : Activate freshwater flux correction.
</LI>
<LI>DIURNAL_SRFLUX : Activate diurnal modulation of the short wave radiation flux.
</LI>
<LI>BULK_FLUX : Activate the bulk parametrization.
</LI>
<LI>BULK_EP: Activate the bulk parametrization for salinity fluxes.

<BR>
<BR>/*                       Lateral Forcing */
</LI>
<LI>SPONGE : Activate areas of enhanced viscosity/diffusion close to the 
lateral open boundaries.
</LI>
<LI>CLIMATOLOGY : Activate processing of climatology data.
</LI>
<LI>ZCLIMATOLOGY : Activate processing of  sea surface height climatology.
</LI>
<LI>M2CLIMATOLOGY : Activate processing of  barotropic velocities climatology.
</LI>
<LI>M3CLIMATOLOGY: Activate processing of  baroclinic velocities climatology.
</LI>
<LI>TCLIMATOLOGY : Activate processing of tracer climatology.
</LI>
<LI>ZNUDGING : Activate open boundary passive/active term + nudging layer for zeta.
</LI>
<LI>M2NUDGING : Activate open boundary passive/active term + nudging layer for ubar and vbar.
</LI>
<LI>M3NUDGING : Activate open boundary passive/active term + nudging layer for u and v.
</LI>
<LI>TNUDGING : Activate open boundary passive/active term + nudging layer for tracers.
</LI>
<LI>ROBUST_DIAG : Activate strong tracer nudging in the interior for diagnostic simulations.
</LI>
<LI>FRC_BRY : Activate direct boundary forcing (roms_bry.nc).
</LI>
<LI>Z_FRC_BRY : Activate boundary forcing for zeta.
</LI>
<LI>M2_FRC_BRY : Activate boundary forcing for ubar and vbar.
</LI>
<LI>M3_FRC_BRY : Activate boundary forcing for u and v.
</LI>
<LI>T_FRC_BRY : Activate boundary forcing for tracers.

<BR>
<BR>/*                       Bottom Forcing */
</LI>
<LI>ANA_BSFLUX : Define if using analytical bottom salinity flux.
</LI>
<LI>ANA_BTFLUX : Define if using analytical bottom temperature flux.

<BR>
<BR>/*                       Point Sources - Rivers */
</LI>
<LI>PSOURCE : Define if using point sources (rivers).
</LI>
<LI>ANA_PSOURCE : Define if using analytical vertical profiles for the point sources
(using fluxes defined in roms.in).

<BR>
<BR>/*                       Lateral Mixing */
</LI>
<LI>UV_VIS2 : Activate Laplacian horizontal mixing of momentum.
</LI>
<LI>MIX_GP_UV : Activate mixing on geopotential (constant Z) surfaces.
</LI>
<LI>SMAGORINSKY : Activate Smagorinsky parametrization for horizontal mixing.
</LI>
<LI>TS_DIF2: Activate Laplacian horizontal mixing of tracers.
</LI>
<LI>MIX_GP_TS : Activate mixing on geopotential (constant Z) surfaces.
</LI>
<LI>CLIMAT_TS_MIXH : Activate horizontal mixing of T-Tclim instead of T for the tracers.

<BR>
<BR>/*                       Vertical Mixing */
</LI>
<LI>BODYFORCE : Define if applying surface and bottom stresses as bodyforces.
</LI>
<LI>BVF_MIXING : Activate a simple mixing scheme based on the Brunt-V&#228;is&#228;l&#228; frequency.
</LI>
<LI>LMD_MIXING : Activate Large/McWilliams/Doney mixing (LMD-KPP closure).
</LI>
<LI>LMD_SKPP : Activate surface boundary layer KPP mixing (LMD-KPP closure). 
</LI>
<LI>LMD_BKPP : Activate bottom boundary layer KPP mixing (LMD-KPP closure). 
</LI>
<LI>LMD_RIMIX : Activate shear instability interior mixing (LMD-KPP closure).
</LI>
<LI>LMD_CONVEC : Activate convection interior mixing (LMD-KPP closure).
</LI>
<LI>LMD_DDMIX : Activate double diffusion interior mixing (LMD-KPP closure). 
</LI>
<LI>LMD_NONLOCAL : Activate nonlocal transport (LMD-KPP closure). 

<BR>
<BR>/*                       Open Boundary Conditions */
</LI>
<LI>OBC_M2FLATHER :  Activate Flather open boundary conditions for ubar and vbar.
</LI>
<LI>OBC_M2CHARACT  :  Activate open boundary conditions based on characteristic methods 
for ubar and vbar.
</LI>
<LI>OBC_VOLCONS : Activate mass conservation enforcement at open boundaries.
</LI>
<LI>OBC_M2ORLANSKI : Activate 2D radiation open boundary conditions for ubar and vbar.
</LI>
<LI>OBC_M2SPECIFIED : Activate specified open boundary conditions for ubar and vbar.
</LI>
<LI>OBC_M3ORLANSKI : Activate 2D radiation open boundary conditions for u and v.
</LI>
<LI>OBC_M3CHARACT : Activate open boundary conditions based on characteristic methods 
for u and v.
</LI>
<LI>OBC_M3SPECIFIED : Activate specified open boundary conditions for u and v.
</LI>
<LI>OBC_TORLANSKI :  Activate 2D radiation open boundary conditions for tracers.
</LI>
<LI>OBC_TUPWIND : Activate upwind open boundary conditions for tracers.
</LI>
<LI>OBC_TSPECIFIED : Activate specified open boundary conditions for tracers.

<BR>
<BR>/*                       Embedding conditions */

<P>
</LI>
<LI>AGRIF_STORE_BAROT_CHILD : Store ubar and vbar during the parent step for the
child boundary conditions (Nesting).
</LI>
<LI>AGRIF_FLUX_BC : Apply parent/child barotropic boundary conditions as 
fluxes (Nesting).
</LI>
<LI>AGRIF_POLY_DUAVG : Apply a third order polynomial temporal interpolation 
for parent/child coupling of DU_avg1 and DU_avg2 (Nesting).
</LI>
<LI>AGRIF_LOCAL_VOLCONS : Enforce parent-child mass conservation (Nesting).
</LI>
<LI>AGRIF_OBC_M2FLATHER :  Activate Flather open boundary conditions for ubar and vbar
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_M2ORLANSKI : Activate 2D radiation open boundary conditions for ubar and vbar
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_M2SPECIFIED : Activate specified open boundary conditions for ubar and vbar
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_M2CHARACT :  Activate open boundary conditions based on characteristic methods 
for ubar and vbar
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_M3ORLANSKI : Activate 2D radiation open boundary conditions for u and v
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_M3SPECIFIED : Activate specified open boundary conditions for u and v
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_M3CHARACT : Activate open boundary conditions based on characteristic methods 
for u and v
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_TORLANSKI :  Activate 2D radiation open boundary conditions for tracers
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_TUPWIND : Activate upwind open boundary conditions for tracers
for the child model (Nesting).
</LI>
<LI>AGRIF_OBC_TSPECIFIED  : Activate specified open boundary conditions for tracers
for the child model (Nesting).

<BR>
<BR>/*           Applications */

<BR>
<BR>/*           Biology */
</LI>
<LI>BIO_NChlPZD : Select a 5 components (Nitrate, Chlorophyll, Phytoplankton, Zooplankton,
Detritus) biogeochemical model.
</LI>
<LI>BIO_N2ChlPZD2 : Select a 7 components (Nitrate, Ammonium, Chlorophyll, Phytoplankton, Zooplankton,
Small Detritus, Large Detritus) biogeochemical model. 
</LI>
<LI>BIO_N2P2Z2D2 : Select a 8 components (Nitrate, Ammonium, Small  Phytoplankton, Large Phytoplankton, 
Small Zooplankton, Large Zooplankton,
Small Detritus, Large Detritus) biogeochemical model. 
</LI>
<LI>DIAGNOSTICS_BIO : Define if writing out fluxes between the biological components.

<BR>
<BR>/*           Floats */
</LI>
<LI>FLOATS_GLOBAL_ATTRIBUTES : Write out global attributes for the floats.
</LI>
<LI>IBM  : Add a fish behavior to the floats (Individual Based Model).
</LI>
<LI>RANDOM_WALK : Add a random walk for the floats dispersion.
</LI>
<LI>DIEL_MIGRATION : Add a vertical daily migration to the floats.
</LI>
<LI>RANDOM_VERTICAL : Add a random walk for the floats depending on the vertical mixing.

<BR>
<BR>/*           Stations */
</LI>
<LI>ALL_SIGMA : Write out all vertical levels in the stations file.

<P>
</LI>
</UL>

<P>
ROMS can be compiled by running the UNIX tcsh script <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/jobcomp.
Jobcomp should be able to recognize your system. It has been tested on 
Linux, IBM, Sun and Compaq systems. On Linux PCs, the default compiler is the GNU g77, 
but it is possible to uncomment specific lines in jobcomp to use g95 or ifort.
The latter is mandatory when using AGRIF and/or OPEN_MP.
When changing the compiler you should provide a corresponding NetCDF library.
Once the compilation is done, you should obtain a new
executable (roms) in the <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run directory.
ROMS should be recompiled each time param.h or cppdefs.h are changed.

<P>

<H2><A NAME="SECTION00046000000000000000">
3.6 Running the model</A>
</H2>

<P>
Edit the input parameter file: <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/roms.in.
The vertical grid parameters (THETA_S,   THETA_B,   HC)
should be identical to the ones in romstools_param.m.
Otherwise, the other default values should not be changed.
The definition of all the input variables is given at the start of each ROMS
simulation.
To run the model, type in directory <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ : ./roms roms.in.
On the screen, you should check the Cu_max parameter: if it is greater than
1 you are violating the CFL criterion. In this case, you should reduce the 
time step.

<BR>Example of model run:
<BR>
<BR><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> : ./roms roms.in

<BR>
<BR>You should obtain :
<BR>---------------------------------------------
<BR> Southern Benguela
<BR>       480  ntimes   Total number of timesteps for 3D equations.
<BR>   5400.00  dt       Timestep [sec] for 3D equations
<BR>        60  ndtfast  Number of 2D timesteps within each 3D step.
<BR>         1  ninfo    Number of timesteps between runtime diagnostics.
<BR>
<BR> 6.000E+00  theta_s  S-coordinate surface control parameter.
<BR> 0.000E+00  theta_b  S-coordinate bottom control parameter.
<BR> 1.000E+01  Tcline   S-coordinate surface/bottom layer width used in
<BR>                                vertical coordinate stretching, meters.
<BR>          Grid File:  ROMS_FILES/roms_grd.nc
<BR>  Forcing Data File:  ROMS_FILES/roms_frc.nc
<BR>     Bulk Data File:  ROMS_FILES/roms_blk.nc
<BR>   Climatology File:  ROMS_FILES/roms_clm.nc
<BR> Initial State File:  ROMS_FILES/roms_ini.nc    Record:  1
<BR>       Restart File:  ROMS_FILES/roms_rst.nc    nrst =   480    rec/file:   -1
<BR>       History File:  ROMS_FILES/roms_his.nc  Create new: T  nwrt = 480  rec/file =  0
<BR>         1  ntsavg      Starting timestep for the accumulation of output
<BR>                                time-averaged data.
<BR>        48  navg        Number of timesteps between writing of time-averaged
<BR>                                data into averages file.
<BR>      Averages File:  ROMS_FILES/roms_avg.nc rec/file =  0
<BR>
<BR> Fields to be saved in history file: (T/F)
<BR>      T  write zeta  free-surface.
<BR>      F  write UBAR  2D U-momentum component.
<BR>      F  write VBAR  2D V-momentum component.
<BR>      F  write U     3D U-momentum component.
<BR>      F  write V     3D V-momentum component.
<BR>      F  write T(1)  Tracer of index 1.
<BR>      F  write T(2)  Tracer of index 2.
<BR>
<BR>      F  write RHO   Density anomaly.
<BR>      F  write Omega Omega vertical velocity.
<BR>      F  write W     True vertical velocity.
<BR>      F  write Akv   Vertical viscosity.
<BR>      F  write Akt   Vertical diffusivity for temperature.
<BR>      F  write Aks   Vertical diffusivity for salinity.
<BR>      F  write Hbl   Depth of KPP-model boundary layer.
<BR>      F  write Bostr Bottom Stress.
<BR>
<BR> Fields to be saved in averages file: (T/F)
<BR>      T  write zeta  free-surface.
<BR>      T  write UBAR  2D U-momentum component.
<BR>      T  write VBAR  2D V-momentum component.
<BR>      T  write U     3D U-momentum component.
<BR>      T  write V     3D V-momentum component.
<BR>      T  write T(1)  Tracer of index 1.
<BR>      T  write T(2)  Tracer of index 2.
<BR>
<BR>      F  write RHO   Density anomaly
<BR>      T  write Omega Omega vertical velocity.
<BR>      T  write W     True vertical velocity.
<BR>      F  write Akv   Vertical viscosity
<BR>      T  write Akt   Vertical diffusivity for temperature.
<BR>      F  write Aks   Vertical diffusivity for salinity.
<BR>      T  write Hbl   Depth of KPP-model boundary layer
<BR>      T  write Bostr Bottom Stress.
<BR> 1025.0000  rho0     Boussinesq approximation mean density, kg/m3.
<BR> 0.000E+00  visc2    Horizontal Laplacian mixing coefficient [m2/s]
<BR>                                for momentum.
<BR> 0.000E+00  tnu2(1)  Horizontal Laplacian mixing coefficient (m2/s)
<BR>                                for tracer 1.
<BR> 0.000E+00  tnu2(2)  Horizontal Laplacian mixing coefficient (m2/s)
<BR>                                for tracer 2.
<BR> 0.000E+00  rdrg     Linear bottom drag coefficient (m/si).
<BR> 0.000E+00  rdrg2    Quadratic bottom drag coefficient.
<BR> 1.000E-02  Zob      Bottom roughness for logarithmic law (m).
<BR> 1.000E-04  Cdb_min  Minimum bottom drag coefficient.
<BR> 1.000E-01  Cdb_max  Maximum bottom drag coefficient.
<BR>
<BR>      1.00  gamma2   Slipperiness parameter: free-slip +1, or no-slip -1.
<BR>  1.00E+05  x_sponge Thickness of sponge and/or nudging layer (m)
<BR>    800.00  v_sponge Viscosity in sponge layer (m2/s)
<BR> 1.157E-05  tauT_in  Nudging coefficients [sec-1]
<BR> 3.215E-08  tauT_out Nudging coefficients [sec-1]
<BR> 1.157E-06  tauM_in  Nudging coefficients [sec-1]
<BR> 3.215E-08  tauM_out Nudging coefficients [sec-1]
<BR>
<BR> Activated C-preprocessing Options:
<BR>
<BR>          REGIONAL
<BR>          BENGUELA
<BR>          OBC_EAST
<BR>          OBC_WEST
<BR>          OBC_NORTH
<BR>          OBC_SOUTH
<BR>          SOLVE3D
<BR>          UV_COR
<BR>          UV_ADV
<BR>          CURVGRID
<BR>          SPHERICAL
<BR>          MASKING
<BR>          AVERAGES
<BR>          AVERAGES_K
<BR>          SALINITY
<BR>          NONLIN_EOS
<BR>          SPLIT_EOS
<BR>          BULK_FLUX
<BR>          BULK_EP
<BR>          SPONGE
<BR>          CLIMATOLOGY
<BR>          ZCLIMATOLOGY
<BR>          M2CLIMATOLOGY
<BR>          M3CLIMATOLOGY
<BR>          TCLIMATOLOGY
<BR>          ZNUDGING
<BR>          M2NUDGING
<BR>          M3NUDGING
<BR>          TNUDGING
<BR>          ANA_BSFLUX
<BR>          ANA_BTFLUX
<BR>          UV_VIS2
<BR>          MIX_GP_UV
<BR>          TS_DIF2
<BR>          MIX_GP_TS
<BR>          CLIMAT_TS_MIXH
<BR>          LMD_MIXING
<BR>          LMD_SKPP
<BR>          LMD_BKPP
<BR>          LMD_RIMIX
<BR>          LMD_CONVEC
<BR>          OBC_M2FLATHER
<BR>          OBC_M3ORLANSKI
<BR>          OBC_TORLANSKI
<BR>          M2FILTER_COSINE
<BR>
<BR>Linux 2.6.9-42.0.3.ELsmp x86_64
<BR> NUMBER OF THREADS:  1 BLOCKING:  1 x  1.
<BR>
<BR> Spherical grid detected.
<BR>
<BR> hmin        hmax         grdmin         grdmax         Cu_min      Cu_max
<BR>   75.000000  4803.032721 .301836927E+05 .331215714E+05  0.12176008  0.91533005
<BR>   volume=9.523986093261087500000E+14   open_cross=6.104836888312444686890E+09
<BR>
<BR> Vertical S-coordinate System:
<BR>
<BR> level   S-coord     Cs-curve          at_hmin  over_slope     at_hmax
<BR>
<BR>    32   0.0000000   0.0000000           0.000       0.000       0.000
<BR>    31  -0.0312500  -0.0009350          -0.373      -2.584      -4.794
<BR>    30  -0.0625000  -0.0019030          -0.749      -5.247      -9.746
<BR>    29  -0.0937500  -0.0029380          -1.128      -8.074     -15.019
<BR>    28  -0.1250000  -0.0040767          -1.515     -11.152     -20.790
<BR>    27  -0.1562500  -0.0053591          -1.911     -14.580     -27.249
<BR>    26  -0.1875000  -0.0068304          -2.319     -18.466     -34.613
<BR>    25  -0.2187500  -0.0085426          -2.743     -22.938     -43.132
<BR>    24  -0.2500000  -0.0105560          -3.186     -28.141     -53.095
<BR>    23  -0.2812500  -0.0129416          -3.654     -34.248     -64.842
<BR>    22  -0.3125000  -0.0157835          -4.151     -41.463     -78.776
<BR>    21  -0.3437500  -0.0191819          -4.684     -50.031     -95.377
<BR>    20  -0.3750000  -0.0232566          -5.262     -60.241    -115.220
<BR>    19  -0.4062500  -0.0281514          -5.892     -72.443    -138.993
<BR>    18  -0.4375000  -0.0340388          -6.588     -87.056    -167.524
<BR>    17  -0.4687500  -0.0411263          -7.361    -104.584    -201.807
<BR>    16  -0.5000000  -0.0496640          -8.228    -125.635    -243.041
<BR>    15  -0.5312500  -0.0599527          -9.209    -150.939    -292.668
<BR>    14  -0.5625000  -0.0723554         -10.328    -181.377    -352.427
<BR>    13  -0.5937500  -0.0873092         -11.613    -218.013    -424.414
<BR>    12  -0.6250000  -0.1053416         -13.097    -262.126    -511.156
<BR>    11  -0.6562500  -0.1270882         -14.823    -315.262    -615.700
<BR>    10  -0.6875000  -0.1533158         -16.841    -379.282    -741.723
<BR>     9  -0.7187500  -0.1849493         -19.209    -456.432    -893.656
<BR>     8  -0.7500000  -0.2231040         -22.002    -549.423   -1076.845
<BR>     7  -0.7812500  -0.2691252         -25.306    -661.522   -1297.738
<BR>     6  -0.8125000  -0.3246355         -29.226    -796.670   -1564.114
<BR>     5  -0.8437500  -0.3915923         -33.891    -959.622   -1885.352
<BR>     4  -0.8750000  -0.4723564         -39.453   -1156.112   -2272.770
<BR>     3  -0.9062500  -0.5697755         -46.098   -1393.057   -2740.015
<BR>     2  -0.9375000  -0.6872846         -54.048   -1678.800   -3303.552
<BR>     1  -0.9687500  -0.8290268         -63.574   -2023.407   -3983.240
<BR>     0  -1.0000000  -1.0000000         -75.000   -2439.016   -4803.033
<BR>
<BR> Time splitting: ndtfast = 60    nfast = 89
<BR> Maximum grid stiffness ratios:   rx0 =0.2353349875  rx1 =  2.5672736953
<BR>
<BR>      GET_INITIAL - Processing data for time =   0.000     record =   1
<BR>
<BR>      GET_TCLIMA - Read climatology of tracer   1 for time =    345.0 
<BR>      GET_TCLIMA - Read climatology of tracer   1 for time =    15.00 
<BR>      GET_TCLIMA - Read climatology of tracer   2 for time =    345.0 
<BR>      GET_TCLIMA - Read climatology of tracer   2 for time =    15.00 
<BR>      GET_UCLIMA - Read momentum climatology      for time =    345.0 
<BR>      GET_UCLIMA - Read momentum climatology      for time =    15.00 
<BR>      GET_SSH     - Read SSH climatology           for time =    345.0 
<BR>      GET_SSH     - Read SSH climatology           for time =    15.00 
<BR>      GET_SMFLUX - Read surface momentum stresses for time =    345.0 
<BR>      GET_SMFLUX - Read surface momentum stresses for time =    15.00 
<BR>      GET_BULK   - Read fields for bulk formula   for time =    345.0 
<BR>      GET_BULK   - Read fields for bulk formula   for time =    15.00 
<BR>
<BR>      DEF_HIS/AVG - Created new netCDF file 'ROMS_FILES/roms_his.nc'.
<BR>      WRT_GRID - wrote grid data into file 'ROMS_FILES/roms_his.nc'.
<BR>      WRT_HIS - wrote history fields into time record =   1 /   1
<BR>
<BR> MAIN: started time-steping.
<BR>
<BR> STEP   time[DAYS] KINETIC_ENRG    POTEN_ENRG    TOTAL_ENRG    NET_VOLUME   trd
<BR>     0     0.00000 0.000000000E+00 2.1475858E+01 2.1475858E+01 9.5239861E+14  0
<BR>     1     0.06250 1.306369099E-04 2.1476230E+01 2.1476361E+01 9.5239208E+14  0
<BR>...
<BR>---------------------------------------------
<BR>
<P>

<H2><A NAME="SECTION00047000000000000000">
3.7 Long simulations</A>
</H2>

<P>
In many studies, there is a need for long simulations: to reach the spin-up of 
the solution and/or to obtain statistical equilibriums.
For regional models, 10 years appears to be a reasonable model simulation length.
In this case, to prevent the generation of large output files, the strategy 
is to relaunch the model every simulated month.
This is done by the UNIX csh script: run_roms.csh .
Warning! the ROMS input file use for long simulations is roms_inter.in.
It should be edited accordingly.

<P>

<OL>
<LI>It gets the grid, the forcing, the initial and the boundary files.
</LI>
<LI>It runs the model for 1 month.
</LI>
<LI>It stores the output files in a specific form: roms_avg_Y4M3.nc (for the ROMS 
averaged output of March of year 4).
</LI>
<LI>It replaces the initial file by the restart file (roms_rst.nc) which as 
been generated at the end of the month.
</LI>
<LI>It relaunch the model for next month.
</LI>
</OL>

<P>
Part to edit in run_roms.csh:
<BR>
<BR>set MODEL=roms 
<BR>set SCRATCHDIR=`pwd`/SCRATCH 
<BR>set INPUTDIR=`pwd` 
<BR>set MSSDIR=`pwd`/ROMS_FILES 
<BR>set MSSOUT=`pwd`/ROMS_FILES 
<BR>set CODFILE=roms 
<BR>set AGRIF_FILE=AGRIF_FixedGrids.in 
<BR># 
<BR># Model time step [seconds] 
<BR># 
<BR>set DT=5400 
<BR># 
<BR># Number of days per month 
<BR># 
<BR>set NDAYS = 30 
<BR># 
<BR># number total of grid levels 
<BR># 
<BR>set NLEVEL=1 
<BR># 
<BR>#  Time Schedule  -  TIME_SCHED=0 -<IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> yearly files 
<BR>#                    TIME_SCHED=1 -<IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> monthly files 
<BR># 
<BR>set TIME_SCHED=1 
<BR># 
<BR>set NY_START=1 
<BR>set NY_END=10 
<BR>set NM_START=1 
<BR>set NM_END=12 
<BR>
<BR>
<P>
Variables definitions:

<UL>
<LI>MODEL=roms : Name used for the input files. For example roms_grd.nc.
</LI>
<LI>SCRATCHDIR=`pwd`/SCRATCH : Scratch directory where the model is run
</LI>
<LI>INPUTDIR=`pwd` : Input directory where the roms_inter.in input file
is.
</LI>
<LI>MSSDIR=`pwd`/ROMS_FILES : Directory where the roms input NetCDF files
(roms_grd.nc, roms_frc.nc, ...) are stored.
</LI>
<LI>MSSOUT=`pwd`/ROMS_FILES : Directory where the roms output NetCDF files
(roms_his.nc, roms_avg.nc, ...) are stored.
</LI>
<LI>CODFILE=roms : ROMS executable.
</LI>
<LI>AGRIF_FILE=AGRIF_FixedGrids.in : AGRIF input file which defines the 
position of child grids when using embedding.
</LI>
<LI>DT=5400 : Model time step in seconds.
</LI>
<LI>NDAYS = 30 : Number of days in 1 month.
</LI>
<LI>NLEVEL=1 : Total number of model grids (no AGRIF: NLEVEL=1).
</LI>
<LI>NY_START=1 : Starting year.
</LI>
<LI>NY_END=10 : Ending Year.
</LI>
<LI>NM_START=1 : Starting month.
</LI>
<LI>NM_END=12 : Ending month.
</LI>
</UL>

<P>
To run a ROMS long simulation in batch mode on a Linux workstation:
<BR>
<P>
<IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> : nohup ./run_roms.csh <IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> exp1.out &amp;
<BR>
<BR>To check the execution of your model, type in the directory
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_Tools/Run :
<BR><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$">: more exp1.out

<H2><A NAME="SECTION00048000000000000000">
3.8 Getting the results</A>
</H2>

<P>

<H3><A NAME="SECTION00048100000000000000">
3.8.1 roms_gui</A>
</H3>

<P>
Once the model has run, or during the simulation, it is possible
to visualize the model outputs using a Matlab graphic user interface : 
roms_gui. Launch roms_gui in the Matlab session 
(in the  <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ directory):

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> 
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> roms_gui

<BR>
<BR>A window pops up, asking for a ROMS history NetCDF file (Figure <A HREF="#fig:open">4</A>).
You should select roms_his.nc (history file) or roms_avg.nc (average file) and
click "open".

<DIV ALIGN="CENTER"><A NAME="fig:open"></A><A NAME="551"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 4:</STRONG>
Entrance window of roms_gui</CAPTION>
<TR><TD><IMG
 WIDTH="226" HEIGHT="267" BORDER="0"
 SRC="img20.png"
 ALT="\begin{figure}\centerline{\psfig{figure=roms_gui_select.eps,width=5cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<BR>
<DIV ALIGN="CENTER"><A NAME="fig:romsgui"></A><A NAME="556"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 5:</STRONG>
roms_gui</CAPTION>
<TR><TD><IMG
 WIDTH="407" HEIGHT="375" BORDER="0"
 SRC="img21.png"
 ALT="\begin{figure}\centerline{\psfig{figure=roms_gui.eps,width=9cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
The main window appears, variables can be selected to obtain an image such as
Figure (<A HREF="#fig:romsgui">5</A>). On the left side, the upper box  gives the available 
ROMS variable names and the lower box presents the variables derived from the
ROMS model outputs :

<P>

<UL>
<LI>Ke : Horizontal slice of kinetic energy: <IMG
 WIDTH="88" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img22.png"
 ALT="$0.5(u^2+v^2)$">.
</LI>
<LI>Rho : Horizontal slice of density using the non-linear equation of state 
for seawater of <A
 HREF="doc.html#Jac95">Jackett and McDougall (1995)</A>.
</LI>
<LI>Pot_Rho : Horizontal slice of the potential density.
</LI>
<LI>Bvf : Horizontal slice of the Brunt-V&#228;is&#228;la frequency: 
<!-- MATH
 $N^2=-\frac{g}{\rho}\frac{\partial \rho}{\partial z}$
 -->
<IMG
 WIDTH="88" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="img23.png"
 ALT="$N^2=-\frac{g}{\rho}\frac{\partial \rho}{\partial z}$"> 
</LI>
<LI>Vort : Horizontal slice of vorticity: <!-- MATH
 $\frac{\partial v}{\partial x}-
\frac{\partial u}{\partial y}$
 -->
<IMG
 WIDTH="61" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img24.png"
 ALT="$\frac{\partial v}{\partial x}-
\frac{\partial u}{\partial y}$">.
</LI>
<LI>Pot_vort : Horizontal slice of the vertical component of Ertel's potential vorticity:
<!-- MATH
 $\frac{\partial \lambda}{\partial z} \left [ f + 
\left (\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}\right ) \right ]$
 -->
<IMG
 WIDTH="145" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="img25.png"
 ALT="$\frac{\partial \lambda}{\partial z} \left [ f +
\left (\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}\right ) \right ]$">.
In our case, <IMG
 WIDTH="43" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img26.png"
 ALT="$\lambda=\rho$">.
</LI>
<LI>Psi : Horizontal slice of stream function: 
<!-- MATH
 $\nabla^2 \psi=\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}$
 -->
<IMG
 WIDTH="113" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img27.png"
 ALT="$\nabla^2 \psi=\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}$">.
This routine might be costly since it inverses the Laplacian of the vorticity
(using a successive over relaxation solver).
</LI>
<LI>Speed : Horizontal slice of the ocean currents velocity : <!-- MATH
 $\sqrt{u^2+v^2}$
 -->
<IMG
 WIDTH="68" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img28.png"
 ALT="$\sqrt{u^2+v^2}$">.
</LI>
<LI>Transport : Horizontal slice of the transport stream function : 
<!-- MATH
 $\nabla^2 S_{vd}=\frac{\partial \bar{v}}{\partial x}-\frac{\partial \bar{u}}{\partial y}$
 -->
<IMG
 WIDTH="126" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="img29.png"
 ALT="$\nabla^2 S_{vd}=\frac{\partial \bar{v}}{\partial x}-\frac{\partial \bar{u}}{\partial y}$">.
</LI>
<LI>Okubo : Horizontal slice of the Okubo-Weiss parameter : 
<!-- MATH
 $\Lambda^2=
\left ( \frac{\partial u}{\partial x}-\frac{\partial v}{\partial y} \right )^2+
\left ( \frac{\partial v}{\partial x}+\frac{\partial u}{\partial y} \right )^2-
\left ( \frac{\partial v}{\partial x}-\frac{\partial u}{\partial y} \right )^2$
 -->
<IMG
 WIDTH="331" HEIGHT="51" ALIGN="MIDDLE" BORDER="0"
 SRC="img30.png"
 ALT="$\Lambda^2=
\left ( \frac{\partial u}{\partial x}-\frac{\partial v}{\partial y} ...
...
\left ( \frac{\partial v}{\partial x}-\frac{\partial u}{\partial y} \right )^2$">.
</LI>
<LI>Chla : Compute a chlorophyll-a from Large and Small phytoplankton concentrations.
</LI>
<LI>z_SST_1C : Depth of 1<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">C below SST.
</LI>
<LI>z_rho_1.25 : Depth of 1.25 kg.m<IMG
 WIDTH="21" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img31.png"
 ALT="$^{-3}$"> below surface density.
</LI>
<LI>z_max_bvf : Depth of the maximum of the  Brunt-V&#228;is&#228;la frequency.
</LI>
<LI>z_max_dtdz : Depth of the maximum  vertical temperature gradient.
</LI>
<LI>z_20C : Depth of the 20<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">C isotherm.
</LI>
<LI>z_15C : Depth of the 15<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img7.png"
 ALT="$^\circ$">C isotherm.
</LI>
<LI>z_sig27 : Depth of the 1027 kg.m<IMG
 WIDTH="21" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img31.png"
 ALT="$^{-3}$"> density layer.
</LI>
<LI>r_factor : <!-- MATH
 $r=\frac{\nabla h}{2h}=\frac{h_{+1/2}-h_{-1/2}}{h_{+1/2}+h_{-1/2}}$
 -->
<IMG
 WIDTH="156" HEIGHT="42" ALIGN="MIDDLE" BORDER="0"
 SRC="img32.png"
 ALT="$r=\frac{\nabla h}{2h}=\frac{h_{+1/2}-h_{-1/2}}{h_{+1/2}+h_{-1/2}}$">
</LI>
</UL>

<P>
It is possible to add arrows for the horizontal currents by increasing the "Current vectors 
spatial step". It is also possible to obtain vertical sections, time series, vertical profiles
and Hovm&#252;ller diagrams by clicking on the corresponding targets in roms_gui.

<P>

<H3><A NAME="SECTION00048200000000000000">
3.8.2 Diagnostics</A>
</H3>

<P>
To analyze the long simulations,
a few scripts have been added in the directory: 
<BR><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Diagnostic_tools:

<UL>
<LI>roms_diags.m : Get volume and surface averaged quantities from a ROMS simulation.
</LI>
<LI>plot_diags.m :  Plot the averaged quantities computed by roms_diags.m.
</LI>
<LI>get_Mmean.m  : Get the monthly mean climatology.
</LI>
<LI>get_Smean.m  : Get the seasonal and annual mean climatology from the outputs of
get_Mmean.m.
</LI>
<LI>get_Meddy.m  : Get the monthly variance climatology (if the variable nonseannal = 1, 
the non-seasonal variance is computed; i.e., the seasonal variation are 
filtered). It needs that get_Mmean.m and get_Smean.m are run before.
</LI>
<LI>get_Seddy.m  : Get the seasonal and annual RMS from the results of 
get_Meddy.m.
</LI>
<LI>roms_anim.m  : Create an animation from the monthly  history or average files.
</LI>
</UL>
Run these scripts in a Matlab session.
The obtained mean or eddy files can be visualized with roms_gui.
<BR>
<P>
If you need to create and play ".fli" animations, you should install ppm2fli
and xanim on your system. If you have a Linux PC, you can follow these steps:

<OL>
<LI>log in as root
</LI>
<LI>go to the directory where the file is saved.
</LI>
<LI>type : rpm -Uvh  ppm2fli-2.1-1.i386.rpm
</LI>
<LI>type : rpm -Uvh  xanim-2.80.1-12.i386.rpm
</LI>
<LI>log out
</LI>
</OL>
If you are not using a Linux PC, you should ask your 
system administrator to install these programs.
<BR>
<P>

<H1><A NAME="SECTION00050000000000000000">
4 Tides</A>
</H1>
Using the method described by <A
 HREF="doc.html#Fla76">Flather (1976)</A>, ROMS is able to propagate the 
different tidal constituents from its lateral boundaries. To do so, define  
the cpp keys TIDES,  SSH_TIDES and UV_TIDES and recompile the model 
using jobcomp. To work correctly, the model should use the <A
 HREF="doc.html#Fla76">Flather (1976)</A> 
open boundary radiation scheme (cpp key OBC_M2FLATHER defined).
<BR>The tidal components are added to the forcing file (XXX_frc.nc)
by the Matlab program make_tides.m.
Edit the file : <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/romstools_param.m.
The part of the file that you should change is :
<BR>
<BR>%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% 5-Parameters for tidal forcing
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% TPXO file name (TPXO6 or TPXO7)
<BR>%
<BR>tidename=[ROMSTOOLS_dir,'TPXO6/TPXO6.nc'];
<BR>%
<BR>% Number of tides component to process
<BR>%
<BR>Ntides=10;
<BR>%
<BR>% Chose order from the rank in the TPXO file :
<BR>% "M2 S2 N2 K2 K1 O1 P1 Q1 Mf Mm"
<BR>% " 1  2  3  4  5  6  7  8  9 10"
<BR>%
<BR>tidalrank=[1 2 3 4 5 6 7 8 9 10];
<BR>%
<BR>% Compare with tidegauge observations
<BR>%
<BR>lon0=18.37;
<BR>lat0=-33.91;   % Cape Town location
<BR>Z0=1;          % Mean depth of the tidegauge in Cape Town
<BR>
<BR>
<P>
Variables definitions :

<UL>
<LI>tidename=[ROMSTOOLS_dir,'TPXO6/TPXO6.nc'] : Location of the netcdf tidal dataset. 
This file is derived from the Oregon State University global model of ocean tides TPXO.6 
(<A
 HREF="doc.html#Egb02">Egbert and Erofeeva, 2002</A>).  Data sources can be found at 
<BR>http://www.oce.orst.edu/po/research/tide/global.html.
It is also possible to use TPXO7.
</LI>
<LI>Ntides=10 : Number of tidal components to process. Warning!
This value should be identical to the value of the parameter Ntides in param.h:
"parameter (Ntides=10)".
</LI>
<LI>tidalrank=[1 2 3 4 5 6 7 8 9 10] : Order to select the different tidal components.
</LI>
<LI>lon0=18.37;lat0=-33.91;Z0=1 : Location of a tidal gauge to compare the interpolated values
with observations. 
<BR>
<BR>
<BR>
<BR></LI>
</UL>
An important aspect is the definition of time and especially the choice of a 
time origin. This is defined in <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/romstools_param.m:

<BR>
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% 6-Temporal parameters (used for make_tides, make_NCEP, make_OGCM)
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>Yorig         = 1900;               % reference time for vector time
<BR>                                    % in roms initial and forcing files
<BR>%
<BR>Ymin          = 2000;               % first forcing year
<BR>Ymax          = 2000;               % last  forcing year
<BR>Mmin          = 1;                  % first forcing month
<BR>Mmax          = 3;                  % last  forcing month
<BR>%
<BR>Dmin          = 1;                  % Day of initialization
<BR>Hmin          = 0;                  % Hour of initialization
<BR>Min_min       = 0;                  % Minute of initialization
<BR>Smin          = 0;                  % Second of initialization
<BR>%
<BR>SPIN_Long     = 0;                  % SPIN-UP duration in Years
<BR>
<BR>
<BR>The origin of time (Yorig: 1 january of year Yorig) should be kept the same
for all the preprocessing and postprocessing steps.
Save romstools_param.m and run make_tides in the Matlab session:

<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_tides
<BR>
<BR>You should obtain :
<BR>---------------------------------------------
<BR>Start date for nodal correction : 1-Jan-2000
<BR>Reading ROMS grid parameters ...
<BR>Tidal components : M2 S2 N2 K2 K1 O1 P1 Q1 Mf Mm 
<BR>Processing tide : 1 of 10
<BR>...
<BR>---------------------------------------------
<BR>
<P>

<H1><A NAME="SECTION00060000000000000000">
5 Inter-Annual simulations</A>
</H1>
ROMSTOOLS can help to realize inter-annual simulations. In this context, 
we rely on Ocean Global Circulations Models (OGCM) for the lateral 
boundary conditions and a global atmospheric reanalysis for the surface 
forcing (NCEP). To limit the volume of data which needs to be transfered 
over the Internet, we use Opendap to extract only the necessary subgrids. 

<P>

<H2><A NAME="SECTION00061000000000000000">
5.1 Getting the surface forcing data from NCEP</A>
</H2>

<P>
The Matlab script make_NCEP.m is used to obtain the surface forcing data.
It downloads the necessary NCEP surface forcing data (Sea Surface 
Temperature, Wind stress ...) over the Internet, and interpolates them on 
the model grid. Since make_NCEP.m works with the bulk parameterization 
(i.e. the 
BULK_FLUX and BULK_EP cpp keys should be defined in cppdefs.h),
a surface forcing NetCDF file and a bulk NetCDF file are generated for 
each month of your simulation in the directory 
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/ .
The part of the file romstools_param.m that you should change is:
<BR>
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% 7 Parameters for Interannual forcing (SODA, ECCO, NCEP, ...)
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% Path to Forcing data
<BR>%
<BR>FORC_DATA_DIR = [RUN_dir,'DATA/'];
<BR>%
<BR>Download_data = 1;                            % Get data from the OPENDAP sites 
<BR>level         = 0;                            % AGRIF level; 0=parent grid 
<BR>%
<BR>%  Options for make_NCEP
<BR>%
<BR>NCEP_dir= [FORC_DATA_DIR,'NCEP_',ROMS_config,'/']; % NCEP data directory
<BR>makefrc      = 1;                            % 1: Create forcing files
<BR>makeblk      = 1;                            % 1: Create bulk files
<BR>add_tides     = 0;                     % 1: Add the tides (To be done...)
<BR>%
<BR>NCEP_version  = 1;                            % NCEP version:
<BR>%                                 (1: NCEP/NCAR Reanalysis, 1/1/1948 - present
<BR>%                                  2: NCEP-DOE Reanalysis, 1/1/1979 - 12/31/2001)
<BR>%
<BR>
<BR>Variables description :

<UL>
<LI>FORC_DATA_DIR : Directory where the different files downloaded over 
the Internet are stored.
</LI>
<LI>Download_data : Get data from the OPENDAP sites. Should be 1.
</LI>
<LI>level : AGRIF level. The parent grid = 0 and the child grid = 1.
</LI>
<LI>NCEP_dir= [FORC_DATA_DIR,'NCEP_',ROMS_config,'/'] : NCEP data directory. 
This is where NCEP data downloaded over the Internet are stored.
</LI>
<LI>makefrc : Switch to define if the forcing file is generated. Should be 1.
</LI>
<LI>makeblk : Switch to define if the bulk file is generated. Should be 1.
</LI>
<LI>add_tides : Switch to define if the tidal forcing is added. 
</LI>
<LI>NCEP_version : version of the NCEP reanalysis. 1: NCEP/NCAR Reanalysis, 1/1/1948 - present.
2: NCEP-DOE Reanalysis, 1/1/1979 - 12/31/2001.
</LI>
</UL>

<P>
Save romstools_param.m and run make_NCEP in the Matlab session.
You should obtain:

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_NCEP
<BR>Add the paths of the different toolboxes
<BR>Arch : x86_64 - Matlab version : 2006a
<BR>Use of mexnc and loaddap in 64 bits.
<BR>Download NCEP data with OPENDAP
<BR>
<BR>Get NCEP data from 2000 to 2000
<BR>Minimum Longitude: 12.3
<BR>Maximum Longitude: 20.3
<BR>Minimum Latitude: -35.5
<BR>Maximum Latitude: -26.3815
<BR>
<BR>Making output data directory ../Run/DATA/NCEP_Benguela/
<BR>Process the first dataset: http://www.cdc.noaa.gov/cgi-bin/nph-nc/Datasets/ncep.reanalysis/surface_gauss/
<BR>    Create ../Run/DATA/NCEP_Benguela/land.sfc.gauss.nc
<BR>Processing year: 2000
<BR>  Processing month: 1
<BR>    Get air for year 2000 - month 1
<BR>...

<P>

<H2><A NAME="SECTION00062000000000000000">
5.2 Getting the lateral boundary conditions</A>
</H2>

<P>
Initial conditions and lateral boundary conditions and  can be 
obtained from several ocean global circulation models (OGCM) 
such as SODA (<A
 HREF="doc.html#Car05">Carton et al., 2005</A>) or ECCO (<A
 HREF="doc.html#Sta99">Stammer et al., 1999</A>). The SODA 
reanalysis is available from 1958 to 2001 and ECCO is available 
from 1993 until now. The Matlab script make_OGCM.m is used to 
download data over the Internet, and to perform the interpolations 
on the model grid. 
A lateral boundary conditions NetCDF file is generated for each month 
of your simulation in the directory <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/ . 

<BR>
<BR>The part of the file romstools_param.m that you should change is:

<BR>
<BR>%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% Options for make_OGCM 
<BR>%
<BR>%%%%%%%%%%%%%%%%%%%
<BR>OGCM        = 'SODA';                                % Select the OGCM:
SODA(1958-2001), ECCO(1993-2005), ...
<BR>OGCM_dir    = [FORC_DATA_DIR,OGCM,'_',ROMS_config,'/'];  
<BR>bry_prefix  = [ROMS_files_dir,'roms_bry_',OGCM,'_']; 
<BR>clm_prefix  = [ROMS_files_dir,'roms_clm_',OGCM,'_']; 
<BR>ini_prefix  = [ROMS_files_dir,'roms_ini_',OGCM,'_']; 
<BR>OGCM_prefix = [OGCM,'_'];                            
<BR>rmdepth     = 2;                                    
<BR>%                             
<BR>%                        
<BR>
<BR>
<BR>
<BR>Variables description :

<UL>
<LI>OGCM = 'SODA' : Name of the OGCM employed (SODA or ECCO).
</LI>
<LI>OGCM_dir    = [FORC_DATA_DIR,OGCM,'_',ROMS_config,'/']  : 
OGCM data directory.
</LI>
<LI>bry_prefix  = [ROMS_files_dir,'roms_bry_',OGCM,'_'] : 
Left part of the boundary file name.
</LI>
<LI>clm_prefix  = [ROMS_files_dir,'roms_clm_',OGCM,'_'] : 
Left part of the climatology file name.
</LI>
<LI>ini_prefix  = [ROMS_files_dir,'roms_ini_',OGCM,'_'] : 
Left part of the initial file name.
</LI>
<LI>OGCM_prefix = [OGCM,'_'] : 
Left part of the OGCM file name. This is where OGCM data are
stored. 
</LI>
<LI>rmdepth = 2 : Number of bottom levels to remove.
This is useful when there is no valid data at this level.
For example, if the depth in the ROMS domain is shallower 
than the OGCM depth.
</LI>
</UL>
Save romstools_param.m and run make_OGCM in the Matlab session.
You should obtain:

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_OGCM
<BR>Add the paths of the different toolboxes
<BR>Arch : x86_64 - Matlab version : 2006a
<BR>Use of mexnc and loaddap in 64 bits.
<BR>Download data...
<BR>
<BR>Get data from Y2000M1 to Y2000M3
<BR>Minimum Longitude: 12.3
<BR>Maximum Longitude: 20.3
<BR>Minimum Latitude: -35.5
<BR>Maximum Latitude: -26.3815
<BR>
<BR>Making output data directory ../Run/DATA/SODA_Benguela/
<BR>Process the dataset: http://iridl.ldeo.columbia.edu./SOURCES/.CARTON-GIESE/.SODA/.v1p4p3
<BR>Processing year: 2000
<BR>  Processing month: 1
<BR>    Download SODA for 2000 - 1
<BR>    ...SSH
<BR>    ...U
<BR>...

<P>

<H2><A NAME="SECTION00063000000000000000">
5.3 Running the model</A>
</H2>

<P>
Compile the model with jobcomp (and with the 
cpp keys BULK_FLUX and BULK_EP defined) and edit 
the input parameter file 
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/roms_inter.in as for the
climatology experiments. As for the long simulations, a csh script
(run_roms_inter.csh) manages the handling of input and output files.
It also changes the number of time steps so each month has the correct
length. This script takes care of leap years. For example Y1996M2 
(February 1996) is 29 days long.

<P>
Part to edit in run_roms_inter.csh:
<BR>
<BR>#
<BR>set MODEL=roms
<BR>set SCRATCHDIR=`pwd`/SCRATCH
<BR>set INPUTDIR=`pwd`
<BR>set MSSDIR=`pwd`/ROMS_FILES
<BR>set MSSOUT=`pwd`/ROMS_FILES
<BR>set CODFILE=roms
<BR>set AGRIF_FILE=AGRIF_FixedGrids.in
<BR>#
<BR>set BULK_FILES=1
<BR>set FORCING_FILES=1
<BR>set CLIMATOLOGY_FILES=0
<BR>set BOUNDARY_FILES=1
<BR>#
<BR># Atmospheric surface forcing dataset (NCEP, GFS,...)
<BR>#
<BR>set ATMOS=NCEP
<BR>#
<BR># Oceanic boundary and initial dataset (SODA, ECCO,...)
<BR>#
<BR>set OGCM=SODA
<BR>#
<BR># Model time step [seconds]
<BR>#
<BR>set DT=5400
<BR>#
<BR># number total of grid levels (1: No child grid)
<BR>#
<BR>set NLEVEL=1
<BR>#
<BR>set NY_START=2000
<BR>set NY_END=2000
<BR>set NM_START=1
<BR>set NM_END=3
<BR>#
<BR>#  Restart file - RSTFLAG=0 -<IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> No Restart
<BR>#		  RSTFLAG=1 -<IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> Restart
<BR>#
<BR>set RSTFLAG=0
<BR>#
<BR>#  Time Schedule  -  TIME_SCHED=0 -<IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> yearly files
<BR>#                    TIME_SCHED=1 -<IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> monthly files
<BR>#
<BR>set TIME_SCHED=1
<BR>#
<BR>########################################################

<BR>
<BR>Variables definitions:

<UL>
<LI>MODEL=roms : Name used for the input files. For example roms_grd.nc.
</LI>
<LI>SCRATCHDIR=`pwd`/SCRATCH : Scratch directory where the model is run.
</LI>
<LI>INPUTDIR=`pwd` : Input directory where the roms_inter.in input file
is located.
</LI>
<LI>MSSDIR=`pwd`/ROMS_FILES : Directory where the roms input NetCDF files
(roms_grd.nc, roms_frc.nc, ...) are stored.
</LI>
<LI>MSSOUT=`pwd`/ROMS_FILES : Directory where the roms output NetCDF files
(roms_his.nc, roms_avg.nc, ...) are stored.
</LI>
<LI>CODFILE=roms : ROMS executable.
</LI>
<LI>AGRIF_FILE=AGRIF_FixedGrids.in : AGRIF input file which defines the 
position of child grids when using embedding.
</LI>
<LI>BULK_FILES=1 : 1 if using bulk NetCDF files (should be 1 for NCEP).
</LI>
<LI>FORCING_FILES=1 : 1 if using forcing NetCDF files (should be 1 for NCEP).
</LI>
<LI>CLIMATOLOGY_FILES=0 : 1 if using XXX_clm.nc files. Using a climatology
file for each month can take a lot of disc space. It is less costly to use
 boundary files (XXX_bry.nc). 
</LI>
<LI>BOUNDARY_FILES=1 : 1 if using XXX_bry.nc files. 
</LI>
<LI>ATMOS=NCEP : name of the atmospheric reanalysis. For the moment it is only
NCEP.
</LI>
<LI>OGCM=SODA : name of the OGCM for the boundary conditions. SODA or ECCO.
</LI>
<LI>DT=5400 : Model time step in seconds.
</LI>
<LI>NDAYS = 30 : Number of days in 1 month.
</LI>
<LI>NLEVEL=1 : Total number of model grids (no embedding: NLEVEL=1).
</LI>
<LI>NY_START=2000 : Starting year.
</LI>
<LI>NY_END=2000 : Ending Year.
</LI>
<LI>NM_START=1 : Starting month.
</LI>
<LI>NM_END=3 : Ending month.
</LI>
<LI>RSTFLAG=0 : 1 if restarting a simulation
</LI>
<LI>TIME_SCHED=1 : (obsolete) 0 if using yearly files, 1 if using monthly 
files. Since make_NCEP and make_OGCM are creating only monthly
files, it should be always 1.
</LI>
</UL>

<P>
As for ROMS long climatology experiments, inter-annual experiments can be run
in batch mode:
<BR><IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$">: nohup ./run_roms_inter.csh <IMG
 WIDTH="16" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img8.png"
 ALT="$&gt;$"> exp1.out &amp;
<BR>
<BR>
<P>

<H1><A NAME="SECTION00070000000000000000">
6 Embedding</A>
</H1>

<P>

<H2><A NAME="SECTION00071000000000000000">
6.1 Introduction</A>
</H2>

<P>
To address the challenge of bridging the gap between near-shore and
offshore dynamics, a nesting capability has been added to ROMS
and tested for the California Upwelling System (<A
 HREF="doc.html#Pen04">Penven et al., 2006</A>).
The method chosen for embedded griding takes advantage of the AGRIF
(Adaptive Grid Refinement in Fortran) package (<A NAME="tex2html76"
  HREF="doc.html#Bla99">Blayo and Debreu, 1999</A>; <A NAME="tex2html77"
  HREF="doc.html#Deb03b">Debreu and Vouland, 2003</A>; <A NAME="tex2html78"
  HREF="doc.html#Deb00">Debreu, 2000</A>; <A NAME="tex2html79"
  HREF="doc.html#Deb03a">Debreu and Blayo, 2003</A>).
AGRIF is a Fortran 95 package for the inclusion of adaptive mesh refinement
features within a finite difference numerical model. One of
the major advantages of AGRIF in static-grid embedding is the ability to
manage an arbitrary number of fixed grids and an arbitrary number of
embedding levels.

<P>

<DIV ALIGN="CENTER"><A NAME="fig:temp_coupling"></A><A NAME="972"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 6:</STRONG>
Temporal coupling between a parent and a child grid
for a refinement factor of 3.  The coupling is done at the baroclinic
time step.</CAPTION>
<TR><TD><IMG
 WIDTH="582" HEIGHT="166" BORDER="0"
 SRC="img33.png"
 ALT="\begin{figure}\centerline{\psfig{figure=nesting_fig1.eps,width=15cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
A recursive integration procedure manages the time evolution for the
child grids during the time step of the parent grids
(Figure <A HREF="#fig:temp_coupling">6</A>). In order to preserve the CFL 
criterion, for a typical
coefficient of refinement (say, a factor of 3 for a 5 km resolution
grid embedded in a 15 km grid), for each parent time step the child
must be advanced using a time step divided by the coefficient of
refinement as many time as necessary to reach the time of the parent
(Figure (<A HREF="#fig:temp_coupling">6</A>)).  For simple 2-level embedding, the
procedure is as follows:
<BR>
<OL>
<LI>Advance the parent grid by one parent time step.
</LI>
<LI>Interpolate the relevant parent variables in space and time
to get the boundary conditions for the child grid.
</LI>
<LI>Advance the child grid by as much child time steps as necessary
to reach the new parent model time.
</LI>
<LI>Update point by point the parent model by averaging the more
accurate values of the child model (in the case of 2-way embedding).
</LI>
</OL>
The recursive approach used in AGRIF
allows the specification of any number
of embedding level.

<P>

<H2><A NAME="SECTION00072000000000000000">
6.2 Embedded (child) model preparation</A>
</H2>

<P>
To run an embedded model, the user must provide the grid, the surface 
forcing and the initial conditions. To name the different files,
AGRIF employs a specific strategy: if the parent file names are of
the form: XXX.nc, the first child names will be of the form: 
XXX.nc.1, the second: XXX.nc.2, etc... 
This convention is also applied for the "roms.in" input files.

<P>
A graphic user interface (NestGUI) facilitates the generation of 
the different NetCDF files. Launch nestgui in the Matlab session 
(in the <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ directory):

<BR>
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> nestgui

<BR>
<BR>A window pops up, asking for a "PARENT GRID" NetCDF file 
(Figure <A HREF="#fig:nestgui1">7</A>). In our Benguela test case, you should select 
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/roms_grd.nc (grid file) and click "open".
The main window appears (Figure <A HREF="#fig:nestgui2">8</A>).

<P>

<DIV ALIGN="CENTER"><A NAME="fig:nestgui1"></A><A NAME="984"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 7:</STRONG>
Entrance window of NestGUI</CAPTION>
<TR><TD><IMG
 WIDTH="226" HEIGHT="215" BORDER="0"
 SRC="img34.png"
 ALT="\begin{figure}\centerline{\psfig{figure=nesting_select.eps,width=5cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>

<DIV ALIGN="CENTER"><A NAME="fig:nestgui2"></A><A NAME="989"></A>
<TABLE>
<CAPTION ALIGN="BOTTOM"><STRONG>Figure 8:</STRONG>
The NestGUI main window</CAPTION>
<TR><TD><IMG
 WIDTH="543" HEIGHT="434" BORDER="0"
 SRC="img35.png"
 ALT="\begin{figure}\centerline{\psfig{figure=nesting.eps,width=12cm}}\end{figure}"></TD></TR>
</TABLE>
</DIV>

<P>
To generate the child model you should follow several steps:

<P>

<OL>
<LI>To define the child domain, click "Define child" and create
the child domain on the main window. The size of the grid child
(Lchild and Mchild) is now visible. This operation can be redone 
until you are satisfied with the size and the position of the child 
domain. The child domain can be finely tuned using the imin, 
imax, jmin and jmax boxes. 
Be aware that the mask interpolation from the parent grid
to the child grid is not optimal close to corners. Parent/Child
boundaries should be placed where the mask is showing a straight
coastline. A warning will be given during the interpolation
procedure if this is not the case.

<P>
</LI>
<LI>"Interp child" : It generates the child grid file. Before, 
you should select if you are using a new topography
("New child topo" button) for the child
grid or if you are just interpolating the parent topography
on the child grid. In the first case, you should defines
what topography file will be used (e.g. 
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Topo/etopo2.nc or another dataset).
You should also define if you want the volume of the child grid 
to match the volume of the parent close to the parent/child 
boundaries ("Match volume" button, it should be "on" by default).
You should also define define the r factor (<A
 HREF="doc.html#Bec93">Beckmann and Haidvogel, 1993</A>) 
for topography smoothing ("r-factor", 0.25 is safe) and
the number of points to connect the child topography to the
parent topography ("n-band", it follows the relation 
<!-- MATH
 $h_{new}=\alpha.h_{child} + (1-\alpha).h_{parent}$
 -->
<IMG
 WIDTH="234" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="img36.png"
 ALT="$h_{new}=\alpha.h_{child} + (1-\alpha).h_{parent}$">, 
where <IMG
 WIDTH="14" HEIGHT="13" ALIGN="BOTTOM" BORDER="0"
 SRC="img37.png"
 ALT="$\alpha$"> is going from 0 to 1 in "n-band" points 
from the parent/child boundaries).
You should also select the child minimum depth ("Hmin",
it should be lower or equal to the parent minimum depth),
the maximum depth at the coast ("Hmax coast"), the 
number of selective hanning filter passes for the deep 
regions ("n filter deep") and the number of final 
hanning filter passes ("n filter final").

<P>
</LI>
<LI>"Interp forcing": It interpolates the parent 
surface forcing  on the child grid. Select the parent forcing file
to be interpolated (e.g. <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/roms_frc.nc). 
The child forcing file roms_frc.nc.1 will be created. 
The parent surface fluxes are interpolated on the child grid. 
You can use "Interp bulk" if you are using a bulk formula.
In this case, the parent bulk file 
(e.g. <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/roms_blk.nc) will be
interpolated on the child grid.

<P>
</LI>
<LI>"Interp initial": It interpolates parent initial
conditions on the child grid. Select the parent initial file
(e.g. <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/roms_ini.nc).
The child initial file 
(e.g. <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/roms_ini.nc.1) 
will be created.
If the topographies are different between the parent and 
the child grids, the child initial conditions are 
vertically re-interpolated. In this case you should check 
if the options "vertical corrections" and "extrapolations"
are selected.
"Interp biology" can be used to interpolate
parent biological variables for biogeochemical experiments.
"Interp restart" generates a child restart file from 
a parent restart file 
(e.g. <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/ROMSFILES/roms_rst.nc). 
This can be done to "hot start" a child model after the 
spin-up of the parent model.

<P>
</LI>
<LI>You can click on "Create roms.in.*" to generate a
child input file (roms.in.1) from the parent input
file and click on "Create AGRIF_FixedGrids.in" to 
generate a AGRIF_FixedGrids.in file (the file which
defines the child grid position in the parent grid).

<P>
</LI>
</OL>

<P>
"river" can be used to locate the river on the coast.
"Interp clim" can be useful to generate boundary conditions 
to test the child model alone. 

<P>

<H2><A NAME="SECTION00073000000000000000">
6.3 Compiling and running the model</A>
</H2>

<P>
The ROMS nesting procedure needs a Fortran 95 compiler. For Linux PCs,
the Intel Fortran Compiler (ifort) is available at 
<BR>http://www.intel.com/software/products/compilers/flin/noncom.htm.
To be able to compile ROMS with ifort, you should change the corresponding 
comments in jobcomp. Define AGRIF in 
<BR><IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/cppdefs.h.
Other cpp keys are related to AGRIF:

<UL>
<LI>AGRIF_OBC_EAST : Open eastern boundary for the child grids.
</LI>
<LI>AGRIF_OBC_WEST : Open western boundary for the child grids.
</LI>
<LI>AGRIF_OBC_SOUTH : Open southern boundary for the child grids.
</LI>
<LI>AGRIF_OBC_NORTH : Open northern boundary for the child grids.
</LI>
<LI>AGRIF_STORE_BAROT_CHILD : Store ubar and vbar during the parent step for the
child boundary conditions.
</LI>
<LI>AGRIF_FLUX_BC : Apply parent/child barotropic boundary conditions has 
fluxes.
</LI>
<LI>AGRIF_POLY_DUAVG : Apply a third order polynomial temporal interpolation 
for DU_avg1 and DU_avg2.
</LI>
<LI>AGRIF_LOCAL_VOLCONS : Enforce parent-child mass conservation.
</LI>
<LI>AGRIF_OBC_M2FLATHER :  Activate Flather open boundary conditions for ubar and vbar
for the child model .
</LI>
<LI>AGRIF_OBC_M2ORLANSKI : Activate 2D radiation open boundary conditions for ubar and vbar
for the child model.
</LI>
<LI>AGRIF_OBC_M2SPECIFIED : Activate specified open boundary conditions for ubar and vbar
for the child model.
</LI>
<LI>AGRIF_OBC_M2CHARACT :  Activate open boundary conditions based on characteristic methods 
for ubar and vbar
for the child model.
</LI>
<LI>AGRIF_OBC_M3ORLANSKI : Activate 2D radiation open boundary conditions for u and v
for the child model.
</LI>
<LI>AGRIF_OBC_M3SPECIFIED : Activate specified open boundary conditions for u and v
for the child model.
</LI>
<LI>AGRIF_OBC_M3CHARACT : Activate open boundary conditions based on characteristic methods 
for u and v
for the child model.
</LI>
<LI>AGRIF_OBC_TORLANSKI :  Activate 2D radiation open boundary conditions for tracers
for the child model .
</LI>
<LI>AGRIF_OBC_TUPWIND : Activate upwind open boundary conditions for tracers
for the child model.
</LI>
<LI>AGRIF_OBC_TSPECIFIED  : Activate specified open boundary conditions for tracers
for the child model.
</LI>
</UL>
The default definitions should be sufficient for most of the applications.

<BR>
<BR>It is possible to edit the file AGRIF_FixedGrids.in. 
This file contains the child grid positions
(i.e. imin,imax,jmin,jmax) and coefficients of refinement. A first line
gives the number of children grids per parent (if AGRIF_STORE_BAROT_CHILD
is defined, only one child grid can be defined per parent grid). A second
line gives the relative position of each grid and the coefficient of refinement 
for each dimension. 
Edit the input files roms.in.1, roms.in.2 , etc... to define correctly the 
file names and the time steps. To run the model, simply type at the prompt:
roms roms.in.

<P>
To visualize the ROMS model outputs for different grid levels, 
change the value in the "child models" box
in roms_gui.

<P>

<P>

<H1><A NAME="SECTION00080000000000000000">
7 Biology</A>
</H1>
ROMSTOOLS can help for the design of ROMS biogeochemical 
experiments. For the initial conditions and lateral boundary
conditions, WOA provides a seasonal climatology for nitrate
concentration and WOA or SeaWifs can be used to obtain a 
seasonal climatology of surface chlorophyll concentration.
Phytoplankton is estimated by a constant chlorophyll/phytoplankton 
ratio derived from previous simulations. Zooplankton is estimated
in a similar way. The part which should be edited by the user in 
romstools_param.m is:
<BR>
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% Open boundaries and initial conditions parameters
<BR>%   used by make_clim.m, make_biol.m, make_bry.m
<BR>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
<BR>%
<BR>% World Ocean Atlas directory (WOA2001 or WOA2005) 
<BR>%
<BR>woa_dir=[ROMSTOOLS_dir,'WOA2005/'];
<BR>%
<BR>% Surface chlorophyll seasonal climatology (WOA2001 or SeaWifs)
<BR>%
<BR>chla_dir=[ROMSTOOLS_dir,'SeaWifs/'];
<BR>%
<BR>
<BR>Variables description :

<UL>
<LI>woa_dir=[ROMSTOOLS_dir,'WOA2005/'] : Directory where the World Ocean
Atlas 2005 climatology (<A
 HREF="doc.html#Con02">Conkright et al., 2002</A>) is located. The World Ocean
Atlas 2001 climatology can also be used.
</LI>
<LI>chla_dir=[ROMSTOOLS_dir,'SeaWifs/'] : Directory of the surface 
chlorophyll seasonal climatology.
</LI>
</UL>
Run make_biol in the Matlab session :
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$">
<BR><IMG
 WIDTH="29" HEIGHT="29" ALIGN="MIDDLE" BORDER="0"
 SRC="img10.png"
 ALT="$&gt;&gt;$"> make_biol
<BR>
<BR>You should obtain :
<BR>----------------------------------------
<BR>Add_no3: creating variables and attributes for the OA file
<BR>Add_no3: creating variables and attributes for the Climatology file
<BR>
<BR> Ext tracers: Roa = 0 km - default value = NaN
<BR> Ext tracers: horizontal interpolation of the annual data
<BR> Ext tracers: horizontal interpolation of the seasonal data
<BR>time index: 1 of total: 4
<BR>time index: 2 of total: 4
<BR>time index: 3 of total: 4
<BR>time index: 4 of total: 4
<BR> 
<BR> Vertical interpolations
<BR> 
<BR> NO3...
<BR> Time index: 1 of total: 4
<BR> Time index: 2 of total: 4
<BR> Time index: 3 of total: 4
<BR> Time index: 4 of total: 4
<BR> 
<BR> CHla...
<BR>Add_chla: creating variable and attribute
<BR>...
<BR>Make a few plots...
<BR>----------------------------------------
<BR>
<BR>The cpp keys related to biology:

<UL>
<LI>BIO_NChlPZD : Select a 5 components (Nitrate, Chlorophyll, Phytoplankton, 
Zooplankton, Detritus) biogeochemical model.
</LI>
<LI>BIO_N2ChlPZD2 : Select a 7 components (Nitrate, Ammonium, Chlorophyll, 
Phytoplankton, Zooplankton, Small Detritus, Large Detritus) biogeochemical model. 
</LI>
<LI>BIO_N2P2Z2D2 : Select a 8 components (Nitrate, Ammonium, Small  
Phytoplankton, Large Phytoplankton, Small Zooplankton, Large Zooplankton,
Small Detritus, Large Detritus) biogeochemical model. 
</LI>
<LI>DIAGNOSTICS_BIO : Define if writing out fluxes between the biological
components.
<BR></LI>
</UL>

<P>

<H1><A NAME="SECTION00090000000000000000">
8 Operational coastal modeling system</A>
</H1>
An operating coastal modeling system can be designed following the 
assumption that large scale offshore dynamics are slow in comparison 
to the coastal system. The lateral boundary conditions are interpolated 
from the last available ECCO model outputs and are kept constant during
the ROMS simulation. ECCO model outputs are delayed by about two to four 
weeks, but we suppose that they are still relevant for the present large 
scale oceanic structure. The Global Forecast System (GFS) is used for the 
surface forcing. A first day of simulation is run in hindcast mode. This 
will provide the initial conditions for the next simulated day. 
Using GFS as surface forcing and ECCO for the lateral boundary conditions, 
a forecast of 7 days is conducted. A UNIX C-Shell script 
(&nbsp;/Roms_tools/Run/run_roms_forecast.csh) manages
data downloading, the hindcast and forecast simulations
and datas storage.
The script run_roms_forecast.csh starts Matlab in 
batch mode to download
with OPENDAP the lateral boundary conditions from ECCO and 
the surface forcing from GFS. It interpolates the data on ROMS 
grid and launches the hindcast and the forecast runs.

<P>
The script run_roms_forecast.csh should be edited to change the
directory pathways (HOME, RUNDIR, PATH, LD_LIBRAIRY_PATH, MATLAB,...).

<P>
The ROMS input files <IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/roms_hindcast.in and 
<IMG
 WIDTH="16" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.png"
 ALT="$\sim$">/Roms_tools/Run/roms_forecast.in should also be edited to change
the length of the time step and the number of time steps. 
The ROMS input file roms_hindcast.in should be defined such as 
the hindcast run duration
is 1 day and a restart file is generated at the end of the hindcast run.

<P>
The script run_roms_forecast.csh can be relaunched everyday in batch mode 
using crontab.

<P>
 <P>
<H2><A NAME="SECTIONREF">Bibliography</A>
</H2>

<DL COMPACT>
<DT><A NAME="Bec93">
Beckmann, A., Haidvogel, D.B.,
1993.
Numerical simulation of flow around a tall
isolated seamount. Part I: Problem formulation
and model accuracy.
Journal of Physical Oceanography
23,
1736-1753.
<BR>
<P></A>
<DD> 
<DT><A NAME="Bla02">
Blanke, B., Roy, C., Penven, P., Speich, S., 
McWilliams, J.C., Nelson, G.,
2002.
Linking wind and upwelling interannual variability in a
regional model of the southern Benguela,
Geophysical Research Letters
29,
2188-2191.
<BR>
<P></A>
<DD> 
<DT><A NAME="Bla99">
Blayo, E., Debreu, L.,
1999.
Adaptive mesh refinement for finite-difference
ocean models: First experiments.
Journal of Physical Oceanography
29,
1239-1250.
<BR>
<P></A>
<DD> 
<DT><A NAME="Car05">
Carton, J.A., Giese, B.S., Grodsky, S.A., 2005. 
Sea level rise and the warming of the oceans in the 
Simple Ocean Data Assimilation (SODA) ocean reanalysis.
Journal of Geophysical Research
110, C09006, doi:10.1029/2004JC002817.
<BR>
<P></A>
<DD> 
<DT><A NAME="Cas99">
Casey, K.S., Cornillon, P., 1999. 
A comparison of satellite and in situ based
sea surface temperature climatologies. 
Journal of Climate 
12, 1848-1863.
<BR>
<P></A>
<DD> 
<DT><A NAME="Con02">
Conkright, M.E., R.A. Locarnini, H.E. Garcia, T.D. O Brien, 
T.P. Boyer, C. Stephens, J.I. Antonov, 2002. 
World Ocean Atlas 2001: Objective Analyses, Data Statistics, 
and Figures, CD-ROM Documentation. 
National Oceanographic Data Center, 
Silver Spring, MD, 
17 pp.
<BR>
<P></A>
<DD> 
<DT><A NAME="Das94">
Da Silva, A.M., Young, C.C., Levitus, S.
1994.
Atlas of surface marine data 1994,
Vol. 1,
algorithms and procedures,
NOAA Atlas NESDIS 6,
U. S. Department of Commerce,
NOAA,
NESDIS,
USA,
74 pp.
<BR>
<P></A>
<DD> 
<DT><A NAME="Deb00">
Debreu, L.,
2000.
Raffinement adaptatif de maillage et m&#233;thodes de zoom -
application aux mod&#232;les d'oc&#233;an,
2000,
Ph.D. thesis,
Universit&#233; Joseph Fourier,
Grenoble.
<BR>
<P></A>
<DD> 
<DT><A NAME="Deb03a">
Debreu, L., Blayo, E.,
2003.
AGRIF: Adaptive Grid Refinement In Fortran.
<I>submitted to ACM Transactions on Mathematical Software - TOMS</I>.
<BR>
<P></A>
<DD> 
<DT><A NAME="Deb03b">
Debreu, L., Vouland, C.,
2003.
AGRIF: Adaptive Grid Refinement In Fortran.
[Available online http://www-lmc.imag.fr/IDOPT/AGRIF/index.html].
<BR>
<P></A>
<DD> 
<DT><A NAME="Dil03">
Di Lorenzo, E., Miller, A.J., Neilson, D.J., 
Cornuelle, B.D., Moisan, J.R.,
2003.
Modeling observed California Current mesoscale eddies and 
the ecosystem response .
International Journal of Remote Sensing,
in press.
<BR>
<P></A>
<DD> 
<DT><A NAME="Egb02">
Egbert, G., Erofeeva, S., 2002.
Efficient inverse modeling of barotropic ocean tides, 
Journal of Atmospheric and Oceanic Technology
19,
183-204.
<BR>
<P></A>
<DD> 
<DT><A NAME="Fla76">
Flather, R.A., 1976.
A tidal model of the northwest European continental shelf.
M&#233;moires de la Soci&#233;t&#233; Royale des Sciences de Li&#232;ge, 
10, 
141-164.
<BR>
<P></A>
<DD> 
<DT><A NAME="Hai00">
Haidvogel, D.B., Arango, H.G., Hedstrom, K. , Beckmann, A.,
Malanotte-Rizzoli, P., Shchepetkin, A.F.,
2000.
Model Evaluation Experiments in the North Atlantic Basin:
Simulations in Nonlinear Terrain-Following Coordinates.
Dynamics of Atmospheres and Oceans
32 ,
239-281.
<BR>
<P></A>
<DD> 
<DT><A NAME="Han91">
Haney, R.L.,
1991.
On the pressure force over steep
topography in sigma coordinate ocean models.
Journal of Physical Oceanography
21,
610-619.
<BR>
<P></A>
<DD> 
<DT><A NAME="Jac95">
Jackett, D.R., McDougall, T.J.,
1995.
Minimal Adjustment of Hydrostatic Profiles to 
Achieve Static Stability.
Journal of Atmospheric and Oceanic Technology
12,
381-389.
<BR>
<P></A>
<DD> 
<DT><A NAME="Lar94">
Large, W.G., McWilliams, J.C., Doney, S.C.,
1994.
Oceanic vertical mixing: a review and a model
with a nonlocal boundary layer parameterization.
Reviews in Geophysics
32,
363-403.
<BR>
<P></A>
<DD> 
<DT><A NAME="Mac02">
MacCready, P. M., R. D. Hetland, W. R. Geyer, 
Long-Term Isohaline Salt Balance in an Estuary. 
Continental Shelf Research, 22, 1591-1601.
<BR>
<P></A>
<DD> 
<DT><A NAME="Mar01">
Marchesiello, P., McWilliams, J.C., Shchepetkin, A.,
2001.
Open boundary condition for long-term integration of regional oceanic
models.
Ocean Modelling
3,
1-21.
<BR>
<P></A>
<DD> 
<DT><A NAME="Mar03">
Marchesiello, P., McWilliams, J.C., Shchepetkin, A.,
2003.
Equilibrium structure and dynamics of the California Current System.
Journal of Physical Oceanography
33,
753-783.
<BR>
<P></A>
<DD> 
<DT><A NAME="Pen01">
Penven, P., Roy C., Lutjeharms, J.R.E., 
Colin de verdi&#232;re, A., Johnson, A., Shillington, F.,
Fr&#233;on, P., Brundrit, G.,
2001.
A regional hydrodynamic model of the Southern Benguela.
South African Journal of Science
97,
472-476.
<BR>
<P></A>
<DD> 
<DT><A NAME="Pen04">
Penven, P., Debreu, L., Marchesiello,  P., McWilliams, J.C.,
2006.
Application of the ROMS embedding procedure for the Central 
California Upwelling System.
Ocean Modelling
12, 157-187.
<BR>
<P></A>
<DD> 
<DT><A NAME="Pen07"> 
Penven, P., Marchesiello, P., Debreu, L., Lef&#232;vre, J.,
2007.
Software tools for pre- and post-processing of oceanic regional 
simulations.
Environmental Modelling and Software,
in press.
<BR>
<P></A>
<DD> 
<DT><A NAME="Rey94">
Reynolds, R.W., Smith, T.M., 1994. 
Improved global sea surface temperature
analyses using optimum interpolation. 
Journal of Climate.
7, 929-948.
<BR>
<P></A>
<DD> 
<DT><A NAME="Shc98">
Shchepetkin, A.F., McWilliams, J.C.,
1998.
Quasi-monotone advection schemes based on explicit locally
adaptive dissipation.
Monthly Weather Review
126,
1541-1580.
<BR>
<P></A>
<DD> 
<DT><A NAME="Shc03a">
Shchepetkin, A.F., McWilliams, J.C.,
2003.
A method for computing horizontal pressure-gradient force
in an ocean model with a non-aligned vertical coordinate.
Journal of Geophysical Research
108.
<BR>
<P></A>
<DD> 
<DT><A NAME="Shc03b">
Shchepetkin, A.F., McWilliams, J.C.,
2005.
Regional Ocean Model System: a split-explicit ocean model with a
free-surface and topography-following vertical coordinate.
Ocean Modelling
9, 347-404.
<BR>
<P></A>
<DD> 
<DT><A NAME="Smi97">
Smith, W.H.F., Sandwell, D.T.,
1997.
Global seafloor topography from satellite altimetry and ship depth soundings.
Science
277,
1957-1962.
<BR>
<P></A>
<DD> 
<DT><A NAME="Sta99">
Stammer, D., Davis, R., Fu, L.L., Fukumori, I., Giering, R., Lee, T.,
Marotzke, J., Marshall, J., Menemenlis, D., Niiler, P., Wunsch, C.,
Zlotnicki., V., 1999. 
The consortium for estimating the circulation and
climate of the ocean (ECCO) - Science goals and task plan - Report
N<IMG
 WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="img38.png"
 ALT="$^o$">1. 
Techical report, 
Jet Propulsion Laboratory - Massachusetts Institute of
 Technology - Scripps Institution of Oceanography.
<BR>
<P></A>
<DD> 
</DL>
<H1><A NAME="SECTION000110000000000000000">
About this document ...</A>
</H1>
 <P>
This document was generated using the
<A HREF="http://www.latex2html.org/"><STRONG>LaTeX</STRONG>2<tt>HTML</tt></A> translator Version 2002-2-1 (1.70)
<P>
Copyright &#169; 1993, 1994, 1995, 1996,
<A HREF="http://cbl.leeds.ac.uk/nikos/personal.html">Nikos Drakos</A>, 
Computer Based Learning Unit, University of Leeds.
<BR>Copyright &#169; 1997, 1998, 1999,
<A HREF="http://www.maths.mq.edu.au/~ross/">Ross Moore</A>, 
Mathematics Department, Macquarie University, Sydney.
<P>
The command line arguments were: <BR>
 <STRONG>latex2html</STRONG> <TT>-split 0 -white -show_section_numbers -no_navigation doc.tex</TT>
<P>
The translation was initiated by Pierrick Penven on 2007-08-30<BR><HR>
<ADDRESS>
Pierrick Penven
2007-08-30
</ADDRESS>
</BODY>
</HTML>
