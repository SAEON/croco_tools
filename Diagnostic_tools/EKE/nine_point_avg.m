function var=nine_point_avg(var,mask);
warning off
var=var.*mask;
var=(var(4:3:end-1,2:3:end-3)+var(4:3:end-1,3:3:end-2)+var(4:3:end-1,4:3:end-1)+...
     var(3:3:end-2,2:3:end-3)+var(3:3:end-2,3:3:end-2)+var(3:3:end-2,4:3:end-1)+...
     var(2:3:end-3,2:3:end-3)+var(2:3:end-3,3:3:end-2)+var(2:3:end-3,4:3:end-1))./...
    (mask(4:3:end-1,2:3:end-3)+mask(4:3:end-1,3:3:end-2)+mask(4:3:end-1,4:3:end-1)+...
     mask(3:3:end-2,2:3:end-3)+mask(3:3:end-2,3:3:end-2)+mask(3:3:end-2,4:3:end-1)+...
     mask(2:3:end-3,2:3:end-3)+mask(2:3:end-3,3:3:end-2)+mask(2:3:end-3,4:3:end-1));
warning on
return
